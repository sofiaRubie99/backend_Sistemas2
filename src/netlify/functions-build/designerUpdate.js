!function(e,t){for(var s in t)e[s]=t[s]}(exports,function(e){var t={};function s(r){if(t[r])return t[r].exports;var n=t[r]={i:r,l:!1,exports:{}};return e[r].call(n.exports,n,n.exports,s),n.l=!0,n.exports}return s.m=e,s.c=t,s.d=function(e,t,r){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(s.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)s.d(r,n,function(t){return e[t]}.bind(null,n));return r},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s=77)}([function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.noop=t.defaults=t.Debug=t.zipMap=t.CONNECTION_CLOSED_ERROR_MSG=t.shuffle=t.sample=t.resolveTLSProfile=t.parseURL=t.optimizeErrorStack=t.toArg=t.convertMapToArray=t.convertObjectToArray=t.timeout=t.packObject=t.isInt=t.wrapMultiResult=t.convertBufferToString=void 0;const r=s(36),n=s(9);Object.defineProperty(t,"defaults",{enumerable:!0,get:function(){return n.defaults}}),Object.defineProperty(t,"noop",{enumerable:!0,get:function(){return n.noop}});const o=s(39);t.Debug=o.default;const i=s(47);function a(e){const t=parseFloat(e);return!isNaN(e)&&(0|t)===t}t.convertBufferToString=function e(t,s){if(t instanceof Buffer)return t.toString(s);if(Array.isArray(t)){const r=t.length,n=Array(r);for(let o=0;o<r;++o)n[o]=t[o]instanceof Buffer&&"utf8"===s?t[o].toString():e(t[o],s);return n}return t},t.wrapMultiResult=function(e){if(!e)return null;const t=[],s=e.length;for(let r=0;r<s;++r){const s=e[r];s instanceof Error?t.push([s]):t.push([null,s])}return t},t.isInt=a,t.packObject=function(e){const t={},s=e.length;for(let r=1;r<s;r+=2)t[e[r-1]]=e[r];return t},t.timeout=function(e,t){let s=null;const r=function(){s&&(clearTimeout(s),s=null,e.apply(this,arguments))};return s=setTimeout(r,t,new Error("timeout")),r},t.convertObjectToArray=function(e){const t=[],s=Object.keys(e);for(let r=0,n=s.length;r<n;r++)t.push(s[r],e[s[r]]);return t},t.convertMapToArray=function(e){const t=[];let s=0;return e.forEach((function(e,r){t[s]=r,t[s+1]=e,s+=2})),t},t.toArg=function(e){return null==e?"":String(e)},t.optimizeErrorStack=function(e,t,s){const r=t.split("\n");let n,o="";for(n=1;n<r.length&&-1!==r[n].indexOf(s);++n);for(let e=n;e<r.length;++e)o+="\n"+r[e];if(e.stack){const t=e.stack.indexOf("\n");e.stack=e.stack.slice(0,t)+o}return e},t.parseURL=function(e){if(a(e))return{port:e};let t=(0,r.parse)(e,!0,!0);t.slashes||"/"===e[0]||(e="//"+e,t=(0,r.parse)(e,!0,!0));const s=t.query||{},o={};if(t.auth){const e=t.auth.indexOf(":");o.username=-1===e?t.auth:t.auth.slice(0,e),o.password=-1===e?"":t.auth.slice(e+1)}if(t.pathname&&("redis:"===t.protocol||"rediss:"===t.protocol?t.pathname.length>1&&(o.db=t.pathname.slice(1)):o.path=t.pathname),t.host&&(o.host=t.hostname),t.port&&(o.port=t.port),"string"==typeof s.family){const e=Number.parseInt(s.family,10);Number.isNaN(e)||(o.family=e)}return(0,n.defaults)(o,s),o},t.resolveTLSProfile=function(e){let t=null==e?void 0:e.tls;"string"==typeof t&&(t={profile:t});const s=i.default[null==t?void 0:t.profile];return s&&(t=Object.assign({},s,t),delete t.profile,e=Object.assign({},e,{tls:t})),e},t.sample=function(e,t=0){const s=e.length;return t>=s?null:e[t+Math.floor(Math.random()*(s-t))]},t.shuffle=function(e){let t=e.length;for(;t>0;){const s=Math.floor(Math.random()*t);t--,[e[t],e[s]]=[e[s],e[t]]}return e},t.CONNECTION_CLOSED_ERROR_MSG="Connection is closed.",t.zipMap=function(e,t){const s=new Map;return e.forEach((e,r)=>{s.set(e,t[r])}),s}},function(e,t,s){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});const r=s(5),n=s(8),o=s(3),i=s(0);class a{constructor(e,t=[],s={},r){if(this.name=e,this.inTransaction=!1,this.isResolved=!1,this.transformed=!1,this.replyEncoding=s.replyEncoding,this.errorStack=s.errorStack,this.args=t.flat(),this.callback=r,this.initPromise(),s.keyPrefix){const e=s.keyPrefix instanceof Buffer;let t=e?s.keyPrefix:null;this._iterateKeys(r=>r instanceof Buffer?(null===t&&(t=Buffer.from(s.keyPrefix)),Buffer.concat([t,r])):e?Buffer.concat([s.keyPrefix,Buffer.from(String(r))]):s.keyPrefix+r)}s.readOnly&&(this.isReadOnly=!0)}static checkFlag(e,t){return!!this.getFlagMap()[e][t]}static setArgumentTransformer(e,t){this._transformer.argument[e]=t}static setReplyTransformer(e,t){this._transformer.reply[e]=t}static getFlagMap(){return this.flagMap||(this.flagMap=Object.keys(a.FLAGS).reduce((e,t)=>(e[t]={},a.FLAGS[t].forEach(s=>{e[t][s]=!0}),e),{})),this.flagMap}getSlot(){if(void 0===this.slot){const e=this.getKeys()[0];this.slot=null==e?null:n(e)}return this.slot}getKeys(){return this._iterateKeys()}toWritable(e){let t;const s="*"+(this.args.length+1)+"\r\n$"+Buffer.byteLength(this.name)+"\r\n"+this.name+"\r\n";if(this.bufferMode){const e=new u;e.push(s);for(let t=0;t<this.args.length;++t){const s=this.args[t];s instanceof Buffer?0===s.length?e.push("$0\r\n\r\n"):(e.push("$"+s.length+"\r\n"),e.push(s),e.push("\r\n")):e.push("$"+Buffer.byteLength(s)+"\r\n"+s+"\r\n")}t=e.toBuffer()}else{t=s;for(let e=0;e<this.args.length;++e){const s=this.args[e];t+="$"+Buffer.byteLength(s)+"\r\n"+s+"\r\n"}}return t}stringifyArguments(){for(let e=0;e<this.args.length;++e){const t=this.args[e];"string"==typeof t||(t instanceof Buffer?this.bufferMode=!0:this.args[e]=(0,i.toArg)(t))}}transformReply(e){this.replyEncoding&&(e=(0,i.convertBufferToString)(e,this.replyEncoding));const t=a._transformer.reply[this.name];return t&&(e=t(e)),e}setTimeout(e){this._commandTimeoutTimer||(this._commandTimeoutTimer=setTimeout(()=>{this.isResolved||this.reject(new Error("Command timed out"))},e))}initPromise(){const t=new Promise((t,s)=>{if(!this.transformed){this.transformed=!0;const e=a._transformer.argument[this.name];e&&(this.args=e(this.args)),this.stringifyArguments()}this.resolve=this._convertValue(t),this.errorStack?this.reject=t=>{s((0,i.optimizeErrorStack)(t,this.errorStack.stack,e))}:this.reject=s});this.promise=(0,o.default)(t,this.callback)}_iterateKeys(e=(e=>e)){if(void 0===this.keys&&(this.keys=[],(0,r.exists)(this.name))){const t=(0,r.getKeyIndexes)(this.name,this.args);for(const s of t)this.args[s]=e(this.args[s]),this.keys.push(this.args[s])}return this.keys}_convertValue(e){return t=>{try{const s=this._commandTimeoutTimer;s&&(clearTimeout(s),delete this._commandTimeoutTimer),e(this.transformReply(t)),this.isResolved=!0}catch(e){this.reject(e)}return this.promise}}}t.default=a,a.FLAGS={VALID_IN_SUBSCRIBER_MODE:["subscribe","psubscribe","unsubscribe","punsubscribe","ssubscribe","sunsubscribe","ping","quit"],VALID_IN_MONITOR_MODE:["monitor","auth"],ENTER_SUBSCRIBER_MODE:["subscribe","psubscribe","ssubscribe"],EXIT_SUBSCRIBER_MODE:["unsubscribe","punsubscribe","sunsubscribe"],WILL_DISCONNECT:["quit"]},a._transformer={argument:{},reply:{}};const c=function(e){if(1===e.length){if(e[0]instanceof Map)return(0,i.convertMapToArray)(e[0]);if("object"==typeof e[0]&&null!==e[0])return(0,i.convertObjectToArray)(e[0])}return e},l=function(e){if(2===e.length){if(e[1]instanceof Map)return[e[0]].concat((0,i.convertMapToArray)(e[1]));if("object"==typeof e[1]&&null!==e[1])return[e[0]].concat((0,i.convertObjectToArray)(e[1]))}return e};a.setArgumentTransformer("mset",c),a.setArgumentTransformer("msetnx",c),a.setArgumentTransformer("hset",l),a.setArgumentTransformer("hmset",l),a.setReplyTransformer("hgetall",(function(e){if(Array.isArray(e)){const t={};for(let s=0;s<e.length;s+=2){const r=e[s],n=e[s+1];r in t?Object.defineProperty(t,r,{value:n,configurable:!0,enumerable:!0,writable:!0}):t[r]=n}return t}return e}));class u{constructor(){this.length=0,this.items=[]}push(e){this.length+=Buffer.byteLength(e),this.items.push(e)}toBuffer(){const e=Buffer.allocUnsafe(this.length);let t=0;for(const s of this.items){const r=Buffer.byteLength(s);Buffer.isBuffer(s)?s.copy(e,t):e.write(s,t,r),t+=r}return e}}}).call(this,"/")},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(5),n=s(6),o=s(3),i=s(19),a=s(1),c=s(57),l=s(16),u=s(61),f=s(70),h=s(10),p=s(22),d=s(0),y=s(24),m=s(11),g=s(9),b=s(14),S=(0,d.Debug)("redis");class k extends m.default{constructor(e,t,s){if(super(),this.status="wait",this.isCluster=!1,this.reconnectTimeout=null,this.connectionEpoch=0,this.retryAttempts=0,this.manuallyClosing=!1,this._autoPipelines=new Map,this._runningAutoPipelines=new Set,this.parseOptions(e,t,s),n.EventEmitter.call(this),this.resetCommandQueue(),this.resetOfflineQueue(),this.options.Connector)this.connector=new this.options.Connector(this.options);else if(this.options.sentinels){const e=new l.default(this.options);e.emitter=this,this.connector=e}else this.connector=new c.StandaloneConnector(this.options);this.options.scripts&&Object.entries(this.options.scripts).forEach(([e,t])=>{this.defineCommand(e,t)}),this.options.lazyConnect?this.setStatus("wait"):this.connect().catch(g.noop)}static createClient(...e){return new k(...e)}get autoPipelineQueueSize(){let e=0;for(const t of this._autoPipelines.values())e+=t.length;return e}connect(e){const t=new Promise((e,t)=>{if("connecting"===this.status||"connect"===this.status||"ready"===this.status)return void t(new Error("Redis is already connecting/connected"));this.connectionEpoch+=1,this.setStatus("connecting");const{options:s}=this;this.condition={select:s.db,auth:s.username?[s.username,s.password]:s.password,subscriber:!1};const r=this;(0,o.default)(this.connector.connect((function(e,t){r.silentEmit(e,t)})),(function(n,o){if(n)return r.flushQueue(n),r.silentEmit("error",n),t(n),void r.setStatus("end");let i=s.tls?"secureConnect":"connect";if("sentinels"in s&&s.sentinels&&!s.enableTLSForSentinelMode&&(i="connect"),r.stream=o,s.noDelay&&o.setNoDelay(!0),"number"==typeof s.keepAlive&&(o.connecting?o.once(i,()=>{o.setKeepAlive(!0,s.keepAlive)}):o.setKeepAlive(!0,s.keepAlive)),o.connecting){if(o.once(i,u.connectHandler(r)),s.connectTimeout){let e=!1;o.setTimeout(s.connectTimeout,(function(){if(e)return;o.setTimeout(0),o.destroy();const t=new Error("connect ETIMEDOUT");t.errorno="ETIMEDOUT",t.code="ETIMEDOUT",t.syscall="connect",u.errorHandler(r)(t)})),o.once(i,(function(){e=!0,o.setTimeout(0)}))}}else if(o.destroyed){const e=r.connector.firstError;e&&process.nextTick(()=>{u.errorHandler(r)(e)}),process.nextTick(u.closeHandler(r))}else process.nextTick(u.connectHandler(r));o.destroyed||(o.once("error",u.errorHandler(r)),o.once("close",u.closeHandler(r)));const a=function(){r.removeListener("close",c),e()};var c=function(){r.removeListener("ready",a),t(new Error(d.CONNECTION_CLOSED_ERROR_MSG))};r.once("ready",a),r.once("close",c)}))});return(0,o.default)(t,e)}disconnect(e=!1){e||(this.manuallyClosing=!0),this.reconnectTimeout&&!e&&(clearTimeout(this.reconnectTimeout),this.reconnectTimeout=null),"wait"===this.status?u.closeHandler(this)():this.connector.disconnect()}end(){this.disconnect()}duplicate(e){return new k({...this.options,...e})}get mode(){var e;return this.options.monitor?"monitor":(null===(e=this.condition)||void 0===e?void 0:e.subscriber)?"subscriber":"normal"}monitor(e){const t=this.duplicate({monitor:!0,lazyConnect:!1});return(0,o.default)(new Promise((function(e,s){t.once("error",s),t.once("monitoring",(function(){e(t)}))})),e)}sendCommand(e,t){var s,n;if("wait"===this.status&&this.connect().catch(g.noop),"end"===this.status)return e.reject(new Error(d.CONNECTION_CLOSED_ERROR_MSG)),e.promise;if((null===(s=this.condition)||void 0===s?void 0:s.subscriber)&&!a.default.checkFlag("VALID_IN_SUBSCRIBER_MODE",e.name))return e.reject(new Error("Connection in subscriber mode, only subscriber commands may be used")),e.promise;"number"==typeof this.options.commandTimeout&&e.setTimeout(this.options.commandTimeout);let o="ready"===this.status||!t&&"connect"===this.status&&(0,r.exists)(e.name)&&(0,r.hasFlag)(e.name,"loading");if(this.stream&&this.stream.writable?this.stream._writableState&&this.stream._writableState.ended&&(o=!1):o=!1,o)S.enabled&&S("write command[%s]: %d -> %s(%o)",this._getDescription(),null===(n=this.condition)||void 0===n?void 0:n.select,e.name,e.args),t?"isPipeline"in t&&t.isPipeline?t.write(e.toWritable(t.destination.redis.stream)):t.write(e.toWritable(t)):this.stream.write(e.toWritable(this.stream)),this.commandQueue.push({command:e,stream:t,select:this.condition.select}),a.default.checkFlag("WILL_DISCONNECT",e.name)&&(this.manuallyClosing=!0),void 0!==this.options.socketTimeout&&void 0===this.socketTimeoutTimer&&this.setSocketTimeout();else{if(!this.options.enableOfflineQueue)return e.reject(new Error("Stream isn't writeable and enableOfflineQueue options is false")),e.promise;if("quit"===e.name&&0===this.offlineQueue.length)return this.disconnect(),e.resolve(Buffer.from("OK")),e.promise;S.enabled&&S("queue command[%s]: %d -> %s(%o)",this._getDescription(),this.condition.select,e.name,e.args),this.offlineQueue.push({command:e,stream:t,select:this.condition.select})}if("select"===e.name&&(0,d.isInt)(e.args[0])){const t=parseInt(e.args[0],10);this.condition.select!==t&&(this.condition.select=t,this.emit("select",t),S("switch to db [%d]",this.condition.select))}return e.promise}setSocketTimeout(){this.socketTimeoutTimer=setTimeout(()=>{this.stream.destroy(new Error(`Socket timeout. Expecting data, but didn't receive any in ${this.options.socketTimeout}ms.`)),this.socketTimeoutTimer=void 0},this.options.socketTimeout),this.stream.once("data",()=>{clearTimeout(this.socketTimeoutTimer),this.socketTimeoutTimer=void 0,0!==this.commandQueue.length&&this.setSocketTimeout()})}scanStream(e){return this.createScanStream("scan",{options:e})}scanBufferStream(e){return this.createScanStream("scanBuffer",{options:e})}sscanStream(e,t){return this.createScanStream("sscan",{key:e,options:t})}sscanBufferStream(e,t){return this.createScanStream("sscanBuffer",{key:e,options:t})}hscanStream(e,t){return this.createScanStream("hscan",{key:e,options:t})}hscanBufferStream(e,t){return this.createScanStream("hscanBuffer",{key:e,options:t})}zscanStream(e,t){return this.createScanStream("zscan",{key:e,options:t})}zscanBufferStream(e,t){return this.createScanStream("zscanBuffer",{key:e,options:t})}silentEmit(e,t){let s;if("error"===e){if(s=t,"end"===this.status)return;if(this.manuallyClosing&&s instanceof Error&&(s.message===d.CONNECTION_CLOSED_ERROR_MSG||"connect"===s.syscall||"read"===s.syscall))return}return this.listeners(e).length>0?this.emit.apply(this,arguments):(s&&s instanceof Error&&console.error("[ioredis] Unhandled error event:",s.stack),!1)}recoverFromFatalError(e,t,s){this.flushQueue(t,s),this.silentEmit("error",t),this.disconnect(!0)}handleReconnection(e,t){var s;let r=!1;switch(this.options.reconnectOnError&&(r=this.options.reconnectOnError(e)),r){case 1:case!0:"reconnecting"!==this.status&&this.disconnect(!0),t.command.reject(e);break;case 2:"reconnecting"!==this.status&&this.disconnect(!0),(null===(s=this.condition)||void 0===s?void 0:s.select)!==t.select&&"select"!==t.command.name&&this.select(t.select),this.sendCommand(t.command);break;default:t.command.reject(e)}}_getDescription(){let e;return e="path"in this.options&&this.options.path?this.options.path:this.stream&&this.stream.remoteAddress&&this.stream.remotePort?this.stream.remoteAddress+":"+this.stream.remotePort:"host"in this.options&&this.options.host?this.options.host+":"+this.options.port:"",this.options.connectionName&&(e+=` (${this.options.connectionName})`),e}resetCommandQueue(){this.commandQueue=new b}resetOfflineQueue(){this.offlineQueue=new b}parseOptions(...e){const t={};let s=!1;for(let r=0;r<e.length;++r){const n=e[r];if(null!=n)if("object"==typeof n)(0,g.defaults)(t,n);else if("string"==typeof n)(0,g.defaults)(t,(0,d.parseURL)(n)),n.startsWith("rediss://")&&(s=!0);else{if("number"!=typeof n)throw new Error("Invalid argument "+n);t.port=n}}s&&(0,g.defaults)(t,{tls:!0}),(0,g.defaults)(t,k.defaultOptions),"string"==typeof t.port&&(t.port=parseInt(t.port,10)),"string"==typeof t.db&&(t.db=parseInt(t.db,10)),this.options=(0,d.resolveTLSProfile)(t)}setStatus(e,t){S.enabled&&S("status[%s]: %s -> %s",this._getDescription(),this.status||"[empty]",e),this.status=e,process.nextTick(this.emit.bind(this,e,t))}createScanStream(e,{key:t,options:s={}}){return new h.default({objectMode:!0,key:t,redis:this,command:e,...s})}flushQueue(e,t){let s;if((t=(0,g.defaults)({},t,{offlineQueue:!0,commandQueue:!0})).offlineQueue)for(;s=this.offlineQueue.shift();)s.command.reject(e);if(t.commandQueue&&this.commandQueue.length>0)for(this.stream&&this.stream.removeAllListeners("data");s=this.commandQueue.shift();)s.command.reject(e)}_readyCheck(e){const t=this;this.info((function(s,r){if(s)return s.message&&s.message.includes("NOPERM")?(console.warn(`Skipping the ready check because INFO command fails: "${s.message}". You can disable ready check with "enableReadyCheck". More: https://github.com/luin/ioredis/wiki/Disable-ready-check.`),e(null,{})):e(s);if("string"!=typeof r)return e(null,r);const n={},o=r.split("\r\n");for(let e=0;e<o.length;++e){const[t,...s]=o[e].split(":"),r=s.join(":");r&&(n[t]=r)}if(n.loading&&"0"!==n.loading){const s=1e3*(n.loading_eta_seconds||1),r=t.options.maxLoadingRetryTime&&t.options.maxLoadingRetryTime<s?t.options.maxLoadingRetryTime:s;S("Redis server still loading, trying again in "+r+"ms"),setTimeout((function(){t._readyCheck(e)}),r)}else e(null,n)})).catch(g.noop)}}k.Cluster=i.default,k.Command=a.default,k.defaultOptions=f.DEFAULT_REDIS_OPTIONS,(0,y.default)(k,n.EventEmitter),(0,p.addTransactionSupport)(k.prototype),t.default=k},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(33);function n(e){setTimeout((function(){throw e}),0)}t.default=function(e,t,s){return"function"==typeof t&&e.then(e=>{let o;o=void 0!==s&&Object(s).spread&&Array.isArray(e)?r.tryCatch(t).apply(void 0,[null].concat(e)):void 0===e?r.tryCatch(t)(null):r.tryCatch(t)(null,e),o===r.errorObj&&n(o.e)},e=>{if(!e){const t=new Error(e+"");Object.assign(t,{cause:e}),e=t}const s=r.tryCatch(t)(e);s===r.errorObj&&n(s.e)}),e}},function(e,t,s){"use strict";const r=process.version.charCodeAt(1)<55&&46===process.version.charCodeAt(2)?s(34):s(35);e.exports=r},function(e,t,s){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getKeyIndexes=t.hasFlag=t.exists=t.list=void 0;const n=r(s(32));t.list=Object.keys(n.default);const o={};function i(e){"string"!=typeof e&&(e=String(e));const t=e.indexOf("->");return-1===t?e.length:t}t.list.forEach(e=>{o[e]=n.default[e].flags.reduce((function(e,t){return e[t]=!0,e}),{})}),t.exists=function(e){return Boolean(n.default[e])},t.hasFlag=function(e,t){if(!o[e])throw new Error("Unknown command "+e);return Boolean(o[e][t])},t.getKeyIndexes=function(e,t,s){const r=n.default[e];if(!r)throw new Error("Unknown command "+e);if(!Array.isArray(t))throw new Error("Expect args to be an array");const o=[],a=Boolean(s&&s.parseExternalKey),c=(e,t)=>{const s=[],r=Number(e[t]);for(let e=0;e<r;e++)s.push(e+t+1);return s},l=(e,t,s)=>{for(let r=t;r<e.length-1;r+=1)if(String(e[r]).toLowerCase()===s.toLowerCase())return r+1;return null};switch(e){case"zunionstore":case"zinterstore":case"zdiffstore":o.push(0,...c(t,1));break;case"eval":case"evalsha":case"eval_ro":case"evalsha_ro":case"fcall":case"fcall_ro":case"blmpop":case"bzmpop":o.push(...c(t,1));break;case"sintercard":case"lmpop":case"zunion":case"zinter":case"zmpop":case"zintercard":case"zdiff":o.push(...c(t,0));break;case"georadius":{o.push(0);const e=l(t,5,"STORE");e&&o.push(e);const s=l(t,5,"STOREDIST");s&&o.push(s);break}case"georadiusbymember":{o.push(0);const e=l(t,4,"STORE");e&&o.push(e);const s=l(t,4,"STOREDIST");s&&o.push(s);break}case"sort":case"sort_ro":o.push(0);for(let e=1;e<t.length-1;e++){let s=t[e];if("string"!=typeof s)continue;const r=s.toUpperCase();"GET"===r?(e+=1,s=t[e],"#"!==s&&(a?o.push([e,i(s)]):o.push(e))):"BY"===r?(e+=1,a?o.push([e,i(t[e])]):o.push(e)):"STORE"===r&&(e+=1,o.push(e))}break;case"migrate":if(""===t[2])for(let e=5;e<t.length-1;e++){const s=t[e];if("string"==typeof s&&"KEYS"===s.toUpperCase()){for(let s=e+1;s<t.length;s++)o.push(s);break}}else o.push(2);break;case"xreadgroup":case"xread":for(let s="xread"===e?0:3;s<t.length-1;s++)if("STREAMS"===String(t[s]).toUpperCase()){for(let e=s+1;e<=s+(t.length-1-s)/2;e++)o.push(e);break}break;default:if(r.step>0){const e=r.keyStart-1,s=r.keyStop>0?r.keyStop:t.length+r.keyStop+1;for(let t=e;t<s;t+=r.step)o.push(t)}}return o}},function(e,t){e.exports=require("events")},function(e,t){e.exports=require("util")},function(e,t){var s=[0,4129,8258,12387,16516,20645,24774,28903,33032,37161,41290,45419,49548,53677,57806,61935,4657,528,12915,8786,21173,17044,29431,25302,37689,33560,45947,41818,54205,50076,62463,58334,9314,13379,1056,5121,25830,29895,17572,21637,42346,46411,34088,38153,58862,62927,50604,54669,13907,9842,5649,1584,30423,26358,22165,18100,46939,42874,38681,34616,63455,59390,55197,51132,18628,22757,26758,30887,2112,6241,10242,14371,51660,55789,59790,63919,35144,39273,43274,47403,23285,19156,31415,27286,6769,2640,14899,10770,56317,52188,64447,60318,39801,35672,47931,43802,27814,31879,19684,23749,11298,15363,3168,7233,60846,64911,52716,56781,44330,48395,36200,40265,32407,28342,24277,20212,15891,11826,7761,3696,65439,61374,57309,53244,48923,44858,40793,36728,37256,33193,45514,41451,53516,49453,61774,57711,4224,161,12482,8419,20484,16421,28742,24679,33721,37784,41979,46042,49981,54044,58239,62302,689,4752,8947,13010,16949,21012,25207,29270,46570,42443,38312,34185,62830,58703,54572,50445,13538,9411,5280,1153,29798,25671,21540,17413,42971,47098,34713,38840,59231,63358,50973,55100,9939,14066,1681,5808,26199,30326,17941,22068,55628,51565,63758,59695,39368,35305,47498,43435,22596,18533,30726,26663,6336,2273,14466,10403,52093,56156,60223,64286,35833,39896,43963,48026,19061,23124,27191,31254,2801,6864,10931,14994,64814,60687,56684,52557,48554,44427,40424,36297,31782,27655,23652,19525,15522,11395,7392,3265,61215,65342,53085,57212,44955,49082,36825,40952,28183,32310,20053,24180,11923,16050,3793,7920],r=e.exports=function(e){for(var t,r=0,n=-1,o=0,i=0,a="string"==typeof e?function(e){for(var t,s=0,r=0,n=[],o=e.length;s<o;s++)(t=e.charCodeAt(s))<128?n[r++]=t:t<2048?(n[r++]=t>>6|192,n[r++]=63&t|128):55296==(64512&t)&&s+1<e.length&&56320==(64512&e.charCodeAt(s+1))?(t=65536+((1023&t)<<10)+(1023&e.charCodeAt(++s)),n[r++]=t>>18|240,n[r++]=t>>12&63|128,n[r++]=t>>6&63|128,n[r++]=63&t|128):(n[r++]=t>>12|224,n[r++]=t>>6&63|128,n[r++]=63&t|128);return n}(e):e,c=a.length;r<c;){if(t=a[r++],-1===n)123===t&&(n=r);else if(125!==t)i=s[255&(t^i>>8)]^i<<8;else if(r-1!==n)return 16383&i;o=s[255&(t^o>>8)]^o<<8}return 16383&o};e.exports.generateMulti=function(e){for(var t=1,s=e.length,n=r(e[0]);t<s;)if(r(e[t++])!==n)return-1;return n}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isArguments=t.defaults=t.noop=void 0;const r=s(37);t.defaults=r;const n=s(38);t.isArguments=n,t.noop=function(){}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(49);class n extends r.Readable{constructor(e){super(e),this.opt=e,this._redisCursor="0",this._redisDrained=!1}_read(){if(this._redisDrained)return void this.push(null);const e=[this._redisCursor];this.opt.key&&e.unshift(this.opt.key),this.opt.match&&e.push("MATCH",this.opt.match),this.opt.type&&e.push("TYPE",this.opt.type),this.opt.count&&e.push("COUNT",String(this.opt.count)),this.opt.redis[this.opt.command](e,(e,t)=>{e?this.emit("error",e):(this._redisCursor=t[0]instanceof Buffer?t[0].toString():t[0],"0"===this._redisCursor&&(this._redisDrained=!0),this.push(t[1]))})}close(){this._redisDrained=!0}}t.default=n},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(5),n=s(50),o=s(1),i=s(51);class a{constructor(){this.options={},this.scriptsSet={},this.addedBuiltinSet=new Set}getBuiltinCommands(){return c.slice(0)}createBuiltinCommand(e){return{string:l(null,e,"utf8"),buffer:l(null,e,null)}}addBuiltinCommand(e){this.addedBuiltinSet.add(e),this[e]=l(e,e,"utf8"),this[e+"Buffer"]=l(e+"Buffer",e,null)}defineCommand(e,t){const s=new i.default(t.lua,t.numberOfKeys,this.options.keyPrefix,t.readOnly);this.scriptsSet[e]=s,this[e]=u(e,e,s,"utf8"),this[e+"Buffer"]=u(e+"Buffer",e,s,null)}sendCommand(e,t,s){throw new Error('"sendCommand" is not implemented')}}const c=r.list.filter(e=>"monitor"!==e);function l(e,t,s){return void 0===s&&(s=t,t=null),function(...r){const i=t||r.shift();let a=r[r.length-1];"function"==typeof a?r.pop():a=void 0;const c={errorStack:this.options.showFriendlyErrorStack?new Error:void 0,keyPrefix:this.options.keyPrefix,replyEncoding:s};return(0,n.shouldUseAutoPipelining)(this,e,i)?(0,n.executeWithAutoPipelining)(this,e,i,r,a):this.sendCommand(new o.default(i,r,c,a))}}function u(e,t,s,r){return function(...o){const i="function"==typeof o[o.length-1]?o.pop():void 0,a={replyEncoding:r};return this.options.showFriendlyErrorStack&&(a.errorStack=new Error),(0,n.shouldUseAutoPipelining)(this,e,t)?(0,n.executeWithAutoPipelining)(this,e,t,o,i):s.execute(this,o,a,i)}}c.push("sentinel"),c.forEach((function(e){a.prototype[e]=l(e,e,"utf8"),a.prototype[e+"Buffer"]=l(e+"Buffer",e,null)})),a.prototype.call=l("call","utf8"),a.prototype.callBuffer=l("callBuffer",null),a.prototype.send_command=a.prototype.call,t.default=a},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getConnectionName=t.weightSrvRecords=t.groupSrvRecords=t.getUniqueHostnamesFromOptions=t.normalizeNodeOptions=t.nodeKeyToRedisOptions=t.getNodeKey=void 0;const r=s(0),n=s(13);t.getNodeKey=function(e){return e.port=e.port||6379,e.host=e.host||"127.0.0.1",e.host+":"+e.port},t.nodeKeyToRedisOptions=function(e){const t=e.lastIndexOf(":");if(-1===t)throw new Error("Invalid node key "+e);return{host:e.slice(0,t),port:Number(e.slice(t+1))}},t.normalizeNodeOptions=function(e){return e.map(e=>{const t={};if("object"==typeof e)Object.assign(t,e);else if("string"==typeof e)Object.assign(t,(0,r.parseURL)(e));else{if("number"!=typeof e)throw new Error("Invalid argument "+e);t.port=e}return"string"==typeof t.port&&(t.port=parseInt(t.port,10)),delete t.db,t.port||(t.port=6379),t.host||(t.host="127.0.0.1"),(0,r.resolveTLSProfile)(t)})},t.getUniqueHostnamesFromOptions=function(e){const t={};return e.forEach(e=>{t[e.host]=!0}),Object.keys(t).filter(e=>!(0,n.isIP)(e))},t.groupSrvRecords=function(e){const t={};for(const s of e)t.hasOwnProperty(s.priority)?(t[s.priority].totalWeight+=s.weight,t[s.priority].records.push(s)):t[s.priority]={totalWeight:s.weight,records:[s]};return t},t.weightSrvRecords=function(e){if(1===e.records.length)return e.totalWeight=0,e.records.shift();const t=Math.floor(Math.random()*(e.totalWeight+e.records.length));let s=0;for(const[r,n]of e.records.entries())if(s+=1+n.weight,s>t)return e.totalWeight-=n.weight,e.records.splice(r,1),n},t.getConnectionName=function(e,t){const s=`ioredis-cluster(${e})`;return t?`${s}:${t}`:s}},function(e,t){e.exports=require("net")},function(e,t,s){"use strict";function r(e,t){t=t||{};this._capacity=t.capacity,this._head=0,this._tail=0,Array.isArray(e)?this._fromArray(e):(this._capacityMask=3,this._list=new Array(4))}r.prototype.peekAt=function(e){var t=e;if(t===(0|t)){var s=this.size();if(!(t>=s||t<-s))return t<0&&(t+=s),t=this._head+t&this._capacityMask,this._list[t]}},r.prototype.get=function(e){return this.peekAt(e)},r.prototype.peek=function(){if(this._head!==this._tail)return this._list[this._head]},r.prototype.peekFront=function(){return this.peek()},r.prototype.peekBack=function(){return this.peekAt(-1)},Object.defineProperty(r.prototype,"length",{get:function(){return this.size()}}),r.prototype.size=function(){return this._head===this._tail?0:this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)},r.prototype.unshift=function(e){if(0===arguments.length)return this.size();var t=this._list.length;return this._head=this._head-1+t&this._capacityMask,this._list[this._head]=e,this._tail===this._head&&this._growArray(),this._capacity&&this.size()>this._capacity&&this.pop(),this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)},r.prototype.shift=function(){var e=this._head;if(e!==this._tail){var t=this._list[e];return this._list[e]=void 0,this._head=e+1&this._capacityMask,e<2&&this._tail>1e4&&this._tail<=this._list.length>>>2&&this._shrinkArray(),t}},r.prototype.push=function(e){if(0===arguments.length)return this.size();var t=this._tail;return this._list[t]=e,this._tail=t+1&this._capacityMask,this._tail===this._head&&this._growArray(),this._capacity&&this.size()>this._capacity&&this.shift(),this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)},r.prototype.pop=function(){var e=this._tail;if(e!==this._head){var t=this._list.length;this._tail=e-1+t&this._capacityMask;var s=this._list[this._tail];return this._list[this._tail]=void 0,this._head<2&&e>1e4&&e<=t>>>2&&this._shrinkArray(),s}},r.prototype.removeOne=function(e){var t=e;if(t===(0|t)&&this._head!==this._tail){var s=this.size(),r=this._list.length;if(!(t>=s||t<-s)){t<0&&(t+=s),t=this._head+t&this._capacityMask;var n,o=this._list[t];if(e<s/2){for(n=e;n>0;n--)this._list[t]=this._list[t=t-1+r&this._capacityMask];this._list[t]=void 0,this._head=this._head+1+r&this._capacityMask}else{for(n=s-1-e;n>0;n--)this._list[t]=this._list[t=t+1+r&this._capacityMask];this._list[t]=void 0,this._tail=this._tail-1+r&this._capacityMask}return o}}},r.prototype.remove=function(e,t){var s,r=e,n=t;if(r===(0|r)&&this._head!==this._tail){var o=this.size(),i=this._list.length;if(!(r>=o||r<-o||t<1)){if(r<0&&(r+=o),1===t||!t)return(s=new Array(1))[0]=this.removeOne(r),s;if(0===r&&r+t>=o)return s=this.toArray(),this.clear(),s;var a;for(r+t>o&&(t=o-r),s=new Array(t),a=0;a<t;a++)s[a]=this._list[this._head+r+a&this._capacityMask];if(r=this._head+r&this._capacityMask,e+t===o){for(this._tail=this._tail-t+i&this._capacityMask,a=t;a>0;a--)this._list[r=r+1+i&this._capacityMask]=void 0;return s}if(0===e){for(this._head=this._head+t+i&this._capacityMask,a=t-1;a>0;a--)this._list[r=r+1+i&this._capacityMask]=void 0;return s}if(r<o/2){for(this._head=this._head+e+t+i&this._capacityMask,a=e;a>0;a--)this.unshift(this._list[r=r-1+i&this._capacityMask]);for(r=this._head-1+i&this._capacityMask;n>0;)this._list[r=r-1+i&this._capacityMask]=void 0,n--;e<0&&(this._tail=r)}else{for(this._tail=r,r=r+t+i&this._capacityMask,a=o-(t+e);a>0;a--)this.push(this._list[r++]);for(r=this._tail;n>0;)this._list[r=r+1+i&this._capacityMask]=void 0,n--}return this._head<2&&this._tail>1e4&&this._tail<=i>>>2&&this._shrinkArray(),s}}},r.prototype.splice=function(e,t){var s=e;if(s===(0|s)){var r=this.size();if(s<0&&(s+=r),!(s>r)){if(arguments.length>2){var n,o,i,a=arguments.length,c=this._list.length,l=2;if(!r||s<r/2){for(o=new Array(s),n=0;n<s;n++)o[n]=this._list[this._head+n&this._capacityMask];for(0===t?(i=[],s>0&&(this._head=this._head+s+c&this._capacityMask)):(i=this.remove(s,t),this._head=this._head+s+c&this._capacityMask);a>l;)this.unshift(arguments[--a]);for(n=s;n>0;n--)this.unshift(o[n-1])}else{var u=(o=new Array(r-(s+t))).length;for(n=0;n<u;n++)o[n]=this._list[this._head+s+t+n&this._capacityMask];for(0===t?(i=[],s!=r&&(this._tail=this._head+s+c&this._capacityMask)):(i=this.remove(s,t),this._tail=this._tail-u+c&this._capacityMask);l<a;)this.push(arguments[l++]);for(n=0;n<u;n++)this.push(o[n])}return i}return this.remove(s,t)}}},r.prototype.clear=function(){this._list=new Array(this._list.length),this._head=0,this._tail=0},r.prototype.isEmpty=function(){return this._head===this._tail},r.prototype.toArray=function(){return this._copyArray(!1)},r.prototype._fromArray=function(e){var t=e.length,s=this._nextPowerOf2(t);this._list=new Array(s),this._capacityMask=s-1,this._tail=t;for(var r=0;r<t;r++)this._list[r]=e[r]},r.prototype._copyArray=function(e,t){var s=this._list,r=s.length,n=this.length;if((t|=n)==n&&this._head<this._tail)return this._list.slice(this._head,this._tail);var o,i=new Array(t),a=0;if(e||this._head>this._tail){for(o=this._head;o<r;o++)i[a++]=s[o];for(o=0;o<this._tail;o++)i[a++]=s[o]}else for(o=this._head;o<this._tail;o++)i[a++]=s[o];return i},r.prototype._growArray=function(){if(0!=this._head){var e=this._copyArray(!0,this._list.length<<1);this._tail=this._list.length,this._head=0,this._list=e}else this._tail=this._list.length,this._list.length<<=1;this._capacityMask=this._capacityMask<<1|1},r.prototype._shrinkArray=function(){this._list.length>>>=1,this._capacityMask>>>=1},r.prototype._nextPowerOf2=function(e){var t=1<<Math.log(e)/Math.log(2)+1;return Math.max(t,4)},e.exports=r},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=(0,s(0).Debug)("AbstractConnector");t.default=class{constructor(e){this.connecting=!1,this.disconnectTimeout=e}check(e){return!0}disconnect(){if(this.connecting=!1,this.stream){const e=this.stream,t=setTimeout(()=>{r("stream %s:%s still open, destroying it",e.remoteAddress,e.remotePort),e.destroy()},this.disconnectTimeout);e.on("close",()=>clearTimeout(t)),e.end()}}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SentinelIterator=void 0;const r=s(13),n=s(0),o=s(25),i=s(59);t.SentinelIterator=i.default;const a=s(15),c=s(2),l=s(60),u=(0,n.Debug)("SentinelConnector");class f extends a.default{constructor(e){if(super(e.disconnectTimeout),this.options=e,this.emitter=null,this.failoverDetector=null,!this.options.sentinels.length)throw new Error("Requires at least one sentinel to connect to.");if(!this.options.name)throw new Error("Requires the name of master.");this.sentinelIterator=new i.default(this.options.sentinels)}check(e){const t=!e.role||this.options.role===e.role;return t||(u("role invalid, expected %s, but got %s",this.options.role,e.role),this.sentinelIterator.next(),this.sentinelIterator.next(),this.sentinelIterator.reset(!0)),t}disconnect(){super.disconnect(),this.failoverDetector&&this.failoverDetector.cleanup()}connect(e){let t;this.connecting=!0,this.retryAttempts=0;const s=async()=>{const i=this.sentinelIterator.next();if(i.done){this.sentinelIterator.reset(!1);const r="function"==typeof this.options.sentinelRetryStrategy?this.options.sentinelRetryStrategy(++this.retryAttempts):null;let n="number"!=typeof r?"All sentinels are unreachable and retry is disabled.":`All sentinels are unreachable. Retrying from scratch after ${r}ms.`;t&&(n+=" Last error: "+t.message),u(n);const o=new Error(n);if("number"==typeof r)return e("error",o),await new Promise(e=>setTimeout(e,r)),s();throw o}let a=null,c=null;try{a=await this.resolve(i.value)}catch(e){c=e}if(!this.connecting)throw new Error(n.CONNECTION_CLOSED_ERROR_MSG);const l=i.value.host+":"+i.value.port;if(a)return u("resolved: %s:%s from sentinel %s",a.host,a.port,l),this.options.enableTLSForSentinelMode&&this.options.tls?(Object.assign(a,this.options.tls),this.stream=(0,o.connect)(a),this.stream.once("secureConnect",this.initFailoverDetector.bind(this))):(this.stream=(0,r.createConnection)(a),this.stream.once("connect",this.initFailoverDetector.bind(this))),this.stream.once("error",e=>{this.firstError=e}),this.stream;{const r=c?"failed to connect to sentinel "+l+" because "+c.message:"connected to sentinel "+l+" successfully, but got an invalid reply: "+a;return u(r),e("sentinelError",new Error(r)),c&&(t=c),s()}};return s()}async updateSentinels(e){if(!this.options.updateSentinels)return;const t=await e.sentinel("sentinels",this.options.name);Array.isArray(t)&&(t.map(n.packObject).forEach(e=>{if(-1===(e.flags?e.flags.split(","):[]).indexOf("disconnected")&&e.ip&&e.port){const t=this.sentinelNatResolve(h(e));this.sentinelIterator.add(t)&&u("adding sentinel %s:%s",t.host,t.port)}}),u("Updated internal sentinels: %s",this.sentinelIterator))}async resolveMaster(e){const t=await e.sentinel("get-master-addr-by-name",this.options.name);return await this.updateSentinels(e),this.sentinelNatResolve(Array.isArray(t)?{host:t[0],port:Number(t[1])}:null)}async resolveSlave(e){const t=await e.sentinel("slaves",this.options.name);if(!Array.isArray(t))return null;const s=t.map(n.packObject).filter(e=>e.flags&&!e.flags.match(/(disconnected|s_down|o_down)/));return this.sentinelNatResolve(function(e,t){if(0===e.length)return null;let s;if("function"==typeof t)s=t(e);else if(null!==t&&"object"==typeof t){const r=Array.isArray(t)?t:[t];r.sort((e,t)=>(e.prio||(e.prio=1),t.prio||(t.prio=1),e.prio<t.prio?-1:e.prio>t.prio?1:0));for(let t=0;t<r.length;t++){for(let n=0;n<e.length;n++){const o=e[n];if(o.ip===r[t].ip&&o.port===r[t].port){s=o;break}}if(s)break}}s||(s=(0,n.sample)(e));return h(s)}(s,this.options.preferredSlaves))}sentinelNatResolve(e){return e&&this.options.natMap&&this.options.natMap[`${e.host}:${e.port}`]||e}connectToSentinel(e,t){return new c.default({port:e.port||26379,host:e.host,username:this.options.sentinelUsername||null,password:this.options.sentinelPassword||null,family:e.family||("path"in this.options&&this.options.path?void 0:this.options.family),tls:this.options.sentinelTLS,retryStrategy:null,enableReadyCheck:!1,connectTimeout:this.options.connectTimeout,commandTimeout:this.options.sentinelCommandTimeout,...t})}async resolve(e){const t=this.connectToSentinel(e);t.on("error",p);try{return"slave"===this.options.role?await this.resolveSlave(t):await this.resolveMaster(t)}finally{t.disconnect()}}async initFailoverDetector(){var e;if(!this.options.failoverDetector)return;this.sentinelIterator.reset(!0);const t=[];for(;t.length<this.options.sentinelMaxConnections;){const{done:e,value:s}=this.sentinelIterator.next();if(e)break;const r=this.connectToSentinel(s,{lazyConnect:!0,retryStrategy:this.options.sentinelReconnectStrategy});r.on("reconnecting",()=>{var e;null===(e=this.emitter)||void 0===e||e.emit("sentinelReconnecting")}),t.push({address:s,client:r})}this.sentinelIterator.reset(!1),this.failoverDetector&&this.failoverDetector.cleanup(),this.failoverDetector=new l.FailoverDetector(this,t),await this.failoverDetector.subscribe(),null===(e=this.emitter)||void 0===e||e.emit("failoverSubscribed")}}function h(e){return{host:e.ip,port:Number(e.port)}}function p(){}t.default=f},function(e,t){e.exports=require("os")},function(e,t){e.exports=require("crypto")},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(5),n=s(6),o=s(4),i=s(3),a=s(1),c=s(48),l=s(2),u=s(10),f=s(22),h=s(0),p=s(24),d=s(11),y=s(52),m=s(54),g=s(55),b=s(56),S=s(12),k=s(14),v=(0,h.Debug)("cluster"),w=new WeakSet;class E extends d.default{constructor(e,t={}){if(super(),this.slots=[],this._groupsIds={},this._groupsBySlot=Array(16384),this.isCluster=!0,this.retryAttempts=0,this.delayQueue=new b.default,this.offlineQueue=new k,this.isRefreshing=!1,this._refreshSlotsCacheCallbacks=[],this._autoPipelines=new Map,this._runningAutoPipelines=new Set,this._readyDelayedCallbacks=[],this.connectionEpoch=0,n.EventEmitter.call(this),this.startupNodes=e,this.options=(0,h.defaults)({},t,y.DEFAULT_CLUSTER_OPTIONS,this.options),this.options.redisOptions&&this.options.redisOptions.keyPrefix&&!this.options.keyPrefix&&(this.options.keyPrefix=this.options.redisOptions.keyPrefix),"function"!=typeof this.options.scaleReads&&-1===["all","master","slave"].indexOf(this.options.scaleReads))throw new Error('Invalid option scaleReads "'+this.options.scaleReads+'". Expected "all", "master", "slave" or a custom function');this.connectionPool=new g.default(this.options.redisOptions),this.connectionPool.on("-node",(e,t)=>{this.emit("-node",e)}),this.connectionPool.on("+node",e=>{this.emit("+node",e)}),this.connectionPool.on("drain",()=>{this.setStatus("close")}),this.connectionPool.on("nodeError",(e,t)=>{this.emit("node error",e,t)}),this.subscriber=new m.default(this.connectionPool,this),this.options.scripts&&Object.entries(this.options.scripts).forEach(([e,t])=>{this.defineCommand(e,t)}),this.options.lazyConnect?this.setStatus("wait"):this.connect().catch(e=>{v("connecting failed: %s",e)})}connect(){return new Promise((e,t)=>{if("connecting"===this.status||"connect"===this.status||"ready"===this.status)return void t(new Error("Redis is already connecting/connected"));const s=++this.connectionEpoch;this.setStatus("connecting"),this.resolveStartupNodeHostnames().then(r=>{if(this.connectionEpoch!==s)return v("discard connecting after resolving startup nodes because epoch not match: %d != %d",s,this.connectionEpoch),void t(new o.RedisError("Connection is discarded because a new connection is made"));if("connecting"!==this.status)return v("discard connecting after resolving startup nodes because the status changed to %s",this.status),void t(new o.RedisError("Connection is aborted"));this.connectionPool.reset(r);const n=()=>{this.setStatus("ready"),this.retryAttempts=0,this.executeOfflineCommands(),this.resetNodesRefreshInterval(),e()};let i=void 0;const a=()=>{this.invokeReadyDelayedCallbacks(void 0),this.removeListener("close",i),this.manuallyClosing=!1,this.setStatus("connect"),this.options.enableReadyCheck?this.readyCheck((e,t)=>{e||t?(v("Ready check failed (%s). Reconnecting...",e||t),"connect"===this.status&&this.disconnect(!0)):n()}):n()};i=()=>{const e=new Error("None of startup nodes is available");this.removeListener("refresh",a),this.invokeReadyDelayedCallbacks(e),t(e)},this.once("refresh",a),this.once("close",i),this.once("close",this.handleCloseEvent.bind(this)),this.refreshSlotsCache(e=>{e&&e.message===c.default.defaultMessage&&(l.default.prototype.silentEmit.call(this,"error",e),this.connectionPool.reset([]))}),this.subscriber.start()}).catch(e=>{this.setStatus("close"),this.handleCloseEvent(e),this.invokeReadyDelayedCallbacks(e),t(e)})})}disconnect(e=!1){const t=this.status;this.setStatus("disconnecting"),e||(this.manuallyClosing=!0),this.reconnectTimeout&&!e&&(clearTimeout(this.reconnectTimeout),this.reconnectTimeout=null,v("Canceled reconnecting attempts")),this.clearNodesRefreshInterval(),this.subscriber.stop(),"wait"===t?(this.setStatus("close"),this.handleCloseEvent()):this.connectionPool.reset([])}quit(e){const t=this.status;if(this.setStatus("disconnecting"),this.manuallyClosing=!0,this.reconnectTimeout&&(clearTimeout(this.reconnectTimeout),this.reconnectTimeout=null),this.clearNodesRefreshInterval(),this.subscriber.stop(),"wait"===t){const t=(0,i.default)(Promise.resolve("OK"),e);return setImmediate(function(){this.setStatus("close"),this.handleCloseEvent()}.bind(this)),t}return(0,i.default)(Promise.all(this.nodes().map(e=>e.quit().catch(e=>{if(e.message===h.CONNECTION_CLOSED_ERROR_MSG)return"OK";throw e}))).then(()=>"OK"),e)}duplicate(e=[],t={}){const s=e.length>0?e:this.startupNodes.slice(0),r=Object.assign({},this.options,t);return new E(s,r)}nodes(e="all"){if("all"!==e&&"master"!==e&&"slave"!==e)throw new Error('Invalid role "'+e+'". Expected "all", "master" or "slave"');return this.connectionPool.getNodes(e)}delayUntilReady(e){this._readyDelayedCallbacks.push(e)}get autoPipelineQueueSize(){let e=0;for(const t of this._autoPipelines.values())e+=t.length;return e}refreshSlotsCache(e){if(e&&this._refreshSlotsCacheCallbacks.push(e),this.isRefreshing)return;this.isRefreshing=!0;const t=this,s=e=>{this.isRefreshing=!1;for(const t of this._refreshSlotsCacheCallbacks)t(e);this._refreshSlotsCacheCallbacks=[]},r=(0,h.shuffle)(this.connectionPool.getNodes());let n=null;!function e(o){if(o===r.length){const e=new c.default(c.default.defaultMessage,n);return s(e)}const i=r[o],a=`${i.options.host}:${i.options.port}`;v("getting slot cache from %s",a),t.getInfoFromNode(i,(function(r){switch(t.status){case"close":case"end":return s(new Error("Cluster is disconnected."));case"disconnecting":return s(new Error("Cluster is disconnecting."))}r?(t.emit("node error",r,a),n=r,e(o+1)):(t.emit("refresh"),s())}))}(0)}sendCommand(e,t,s){if("wait"===this.status&&this.connect().catch(h.noop),"end"===this.status)return e.reject(new Error(h.CONNECTION_CLOSED_ERROR_MSG)),e.promise;let n=this.options.scaleReads;if("master"!==n){e.isReadOnly||(0,r.exists)(e.name)&&(0,r.hasFlag)(e.name,"readonly")||(n="master")}let i=s?s.slot:e.getSlot();const c={},l=this;if(!s&&!w.has(e)){w.add(e);const t=e.reject;e.reject=function(s){const r=u.bind(null,!0);l.handleError(s,c,{moved:function(t,s){v("command %s is moved to %s",e.name,s),i=Number(t),l.slots[t]?l.slots[t][0]=s:l.slots[t]=[s],l._groupsBySlot[t]=l._groupsIds[l.slots[t].join(";")],l.connectionPool.findOrCreate(l.natMapper(s)),u(),v("refreshing slot caches... (triggered by MOVED error)"),l.refreshSlotsCache()},ask:function(t,s){v("command %s is required to ask %s:%s",e.name,s);const r=l.natMapper(s);l.connectionPool.findOrCreate(r),u(!1,`${r.host}:${r.port}`)},tryagain:r,clusterDown:r,connectionClosed:r,maxRedirections:function(s){t.call(e,s)},defaults:function(){t.call(e,s)}})}}function u(r,c){if("end"===l.status)return void e.reject(new o.AbortError("Cluster is ended."));let u;if("ready"===l.status||"cluster"===e.name){if(s&&s.redis)u=s.redis;else if(a.default.checkFlag("ENTER_SUBSCRIBER_MODE",e.name)||a.default.checkFlag("EXIT_SUBSCRIBER_MODE",e.name)){if(u=l.subscriber.getInstance(),!u)return void e.reject(new o.AbortError("No subscriber for the cluster"))}else{if(!r){if("number"==typeof i&&l.slots[i]){const t=l.slots[i];if("function"==typeof n){const s=t.map((function(e){return l.connectionPool.getInstanceByKey(e)}));u=n(s,e),Array.isArray(u)&&(u=(0,h.sample)(u)),u||(u=s[0])}else{let e;e="all"===n?(0,h.sample)(t):"slave"===n&&t.length>1?(0,h.sample)(t,1):t[0],u=l.connectionPool.getInstanceByKey(e)}}c&&(u=l.connectionPool.getInstanceByKey(c),u.asking())}u||(u=("function"==typeof n?null:l.connectionPool.getSampleInstance(n))||l.connectionPool.getSampleInstance("all"))}s&&!s.redis&&(s.redis=u)}u?u.sendCommand(e,t):l.options.enableOfflineQueue?l.offlineQueue.push({command:e,stream:t,node:s}):e.reject(new Error("Cluster isn't ready and enableOfflineQueue options is false"))}return u(),e.promise}sscanStream(e,t){return this.createScanStream("sscan",{key:e,options:t})}sscanBufferStream(e,t){return this.createScanStream("sscanBuffer",{key:e,options:t})}hscanStream(e,t){return this.createScanStream("hscan",{key:e,options:t})}hscanBufferStream(e,t){return this.createScanStream("hscanBuffer",{key:e,options:t})}zscanStream(e,t){return this.createScanStream("zscan",{key:e,options:t})}zscanBufferStream(e,t){return this.createScanStream("zscanBuffer",{key:e,options:t})}handleError(e,t,s){if(void 0===t.value?t.value=this.options.maxRedirections:t.value-=1,t.value<=0)return void s.maxRedirections(new Error("Too many Cluster redirections. Last error: "+e));const r=e.message.split(" ");if("MOVED"===r[0]){const e=this.options.retryDelayOnMoved;e&&"number"==typeof e?this.delayQueue.push("moved",s.moved.bind(null,r[1],r[2]),{timeout:e}):s.moved(r[1],r[2])}else"ASK"===r[0]?s.ask(r[1],r[2]):"TRYAGAIN"===r[0]?this.delayQueue.push("tryagain",s.tryagain,{timeout:this.options.retryDelayOnTryAgain}):"CLUSTERDOWN"===r[0]&&this.options.retryDelayOnClusterDown>0?this.delayQueue.push("clusterdown",s.connectionClosed,{timeout:this.options.retryDelayOnClusterDown,callback:this.refreshSlotsCache.bind(this)}):e.message===h.CONNECTION_CLOSED_ERROR_MSG&&this.options.retryDelayOnFailover>0&&"ready"===this.status?this.delayQueue.push("failover",s.connectionClosed,{timeout:this.options.retryDelayOnFailover,callback:this.refreshSlotsCache.bind(this)}):s.defaults()}resetOfflineQueue(){this.offlineQueue=new k}clearNodesRefreshInterval(){this.slotsTimer&&(clearTimeout(this.slotsTimer),this.slotsTimer=null)}resetNodesRefreshInterval(){if(this.slotsTimer||!this.options.slotsRefreshInterval)return;const e=()=>{this.slotsTimer=setTimeout(()=>{v('refreshing slot caches... (triggered by "slotsRefreshInterval" option)'),this.refreshSlotsCache(()=>{e()})},this.options.slotsRefreshInterval)};e()}setStatus(e){v("status: %s -> %s",this.status||"[empty]",e),this.status=e,process.nextTick(()=>{this.emit(e)})}handleCloseEvent(e){let t;e&&v("closed because %s",e),this.manuallyClosing||"function"!=typeof this.options.clusterRetryStrategy||(t=this.options.clusterRetryStrategy.call(this,++this.retryAttempts,e)),"number"==typeof t?(this.setStatus("reconnecting"),this.reconnectTimeout=setTimeout(()=>{this.reconnectTimeout=null,v("Cluster is disconnected. Retrying after %dms",t),this.connect().catch((function(e){v("Got error %s when reconnecting. Ignoring...",e)}))},t)):(this.setStatus("end"),this.flushQueue(new Error("None of startup nodes is available")))}flushQueue(e){let t;for(;t=this.offlineQueue.shift();)t.command.reject(e)}executeOfflineCommands(){if(this.offlineQueue.length){v("send %d commands in offline queue",this.offlineQueue.length);const e=this.offlineQueue;let t;for(this.resetOfflineQueue();t=e.shift();)this.sendCommand(t.command,t.stream,t.node)}}natMapper(e){if(this.options.natMap&&"object"==typeof this.options.natMap){const t="string"==typeof e?e:`${e.host}:${e.port}`,s=this.options.natMap[t];if(s)return v("NAT mapping %s -> %O",t,s),Object.assign({},s)}return"string"==typeof e?(0,S.nodeKeyToRedisOptions)(e):e}getInfoFromNode(e,t){if(!e)return t(new Error("Node is disconnected"));const s=e.duplicate({enableOfflineQueue:!0,enableReadyCheck:!1,retryStrategy:null,connectionName:(0,S.getConnectionName)("refresher",this.options.redisOptions&&this.options.redisOptions.connectionName)});s.on("error",h.noop),s.cluster("SLOTS",(0,h.timeout)((e,r)=>{if(s.disconnect(),e)return t(e);if("disconnecting"===this.status||"close"===this.status||"end"===this.status)return v("ignore CLUSTER.SLOTS results (count: %d) since cluster status is %s",r.length,this.status),void t();const n=[];v("cluster slots result count: %d",r.length);for(let e=0;e<r.length;++e){const t=r[e],s=t[0],o=t[1],i=[];for(let e=2;e<t.length;e++){if(!t[e][0])continue;const s=this.natMapper({host:t[e][0],port:t[e][1]});s.readOnly=2!==e,n.push(s),i.push(s.host+":"+s.port)}v("cluster slots result [%d]: slots %d~%d served by %s",e,s,o,i);for(let e=s;e<=o;e++)this.slots[e]=i}this._groupsIds=Object.create(null);let o=0;for(let e=0;e<16384;e++){const t=(this.slots[e]||[]).join(";");t.length?(this._groupsIds[t]||(this._groupsIds[t]=++o),this._groupsBySlot[e]=this._groupsIds[t]):this._groupsBySlot[e]=void 0}this.connectionPool.reset(n),t()},this.options.slotsRefreshTimeout))}invokeReadyDelayedCallbacks(e){for(const t of this._readyDelayedCallbacks)process.nextTick(t,e);this._readyDelayedCallbacks=[]}readyCheck(e){this.cluster("INFO",(t,s)=>{if(t)return e(t);if("string"!=typeof s)return e();let r;const n=s.split("\r\n");for(let e=0;e<n.length;++e){const t=n[e].split(":");if("cluster_state"===t[0]){r=t[1];break}}"fail"===r?(v("cluster state not ok (%s)",r),e(null,r)):e()})}resolveSrv(e){return new Promise((t,s)=>{this.options.resolveSrv(e,(e,r)=>{if(e)return s(e);const n=this,o=(0,S.groupSrvRecords)(r),i=Object.keys(o).sort((e,t)=>parseInt(e)-parseInt(t));!function e(r){if(!i.length)return s(r);const a=i[0],c=o[a],l=(0,S.weightSrvRecords)(c);c.records.length||i.shift(),n.dnsLookup(l.name).then(e=>t({host:e,port:l.port}),e)}()})})}dnsLookup(e){return new Promise((t,s)=>{this.options.dnsLookup(e,(r,n)=>{r?(v("failed to resolve hostname %s to IP: %s",e,r.message),s(r)):(v("resolved hostname %s to IP %s",e,n),t(n))})})}async resolveStartupNodeHostnames(){if(!Array.isArray(this.startupNodes)||0===this.startupNodes.length)throw new Error("`startupNodes` should contain at least one node.");const e=(0,S.normalizeNodeOptions)(this.startupNodes),t=(0,S.getUniqueHostnamesFromOptions)(e);if(0===t.length)return e;const s=await Promise.all(t.map((this.options.useSRVRecords?this.resolveSrv:this.dnsLookup).bind(this))),r=(0,h.zipMap)(t,s);return e.map(e=>{const t=r.get(e.host);return t?this.options.useSRVRecords?Object.assign({},e,t):Object.assign({},e,{host:t}):e})}createScanStream(e,{key:t,options:s={}}){return new u.default({objectMode:!0,key:t,redis:this,command:e,...s})}}(0,p.default)(E,n.EventEmitter),(0,f.addTransactionSupport)(E.prototype),t.default=E},function(e,t){e.exports=require("assert")},function(e,t,s){e.exports=function(e){function t(e){let s,n,o,i=null;function a(...e){if(!a.enabled)return;const r=a,n=Number(new Date),o=n-(s||n);r.diff=o,r.prev=s,r.curr=n,s=n,e[0]=t.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let i=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,(s,n)=>{if("%%"===s)return"%";i++;const o=t.formatters[n];if("function"==typeof o){const t=e[i];s=o.call(r,t),e.splice(i,1),i--}return s}),t.formatArgs.call(r,e);(r.log||t.log).apply(r,e)}return a.namespace=e,a.useColors=t.useColors(),a.color=t.selectColor(e),a.extend=r,a.destroy=t.destroy,Object.defineProperty(a,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==i?i:(n!==t.namespaces&&(n=t.namespaces,o=t.enabled(e)),o),set:e=>{i=e}}),"function"==typeof t.init&&t.init(a),a}function r(e,s){const r=t(this.namespace+(void 0===s?":":s)+e);return r.log=this.log,r}function n(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){if(e instanceof Error)return e.stack||e.message;return e},t.disable=function(){const e=[...t.names.map(n),...t.skips.map(n).map(e=>"-"+e)].join(",");return t.enable(""),e},t.enable=function(e){let s;t.save(e),t.namespaces=e,t.names=[],t.skips=[];const r=("string"==typeof e?e:"").split(/[\s,]+/),n=r.length;for(s=0;s<n;s++)r[s]&&("-"===(e=r[s].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.slice(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){if("*"===e[e.length-1])return!0;let s,r;for(s=0,r=t.skips.length;s<r;s++)if(t.skips[s].test(e))return!1;for(s=0,r=t.names.length;s<r;s++)if(t.names[s].test(e))return!0;return!1},t.humanize=s(42),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach(s=>{t[s]=e[s]}),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){let s=0;for(let t=0;t<e.length;t++)s=(s<<5)-s+e.charCodeAt(t),s|=0;return t.colors[Math.abs(s)%t.colors.length]},t.enable(t.load()),t}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addTransactionSupport=void 0;const r=s(0),n=s(3),o=s(23);t.addTransactionSupport=function(e){e.pipeline=function(e){const t=new o.default(this);return Array.isArray(e)&&t.addBatch(e),t};const{multi:t}=e;e.multi=function(e,s){if(void 0!==s||Array.isArray(e)||(s=e,e=null),s&&!1===s.pipeline)return t.call(this);const i=new o.default(this);i.multi(),Array.isArray(e)&&i.addBatch(e);const a=i.exec;i.exec=function(e){if(this.isCluster&&!this.redis.slots.length)return"wait"===this.redis.status&&this.redis.connect().catch(r.noop),(0,n.default)(new Promise((e,t)=>{this.redis.delayUntilReady(s=>{s?t(s):this.exec(i).then(e,t)})}),e);if(this._transactions>0&&a.call(i),this.nodeifiedPromise)return a.call(i);const t=a.call(i);return(0,n.default)(t.then((function(e){const t=e[e.length-1];if(void 0===t)throw new Error("Pipeline cannot be used to send any commands when the `exec()` has been called on it.");if(t[0]){t[0].previousErrors=[];for(let s=0;s<e.length-1;++s)e[s][0]&&t[0].previousErrors.push(e[s][0]);throw t[0]}return(0,r.wrapMultiResult)(t[1])})),e)};const{execBuffer:c}=i;return i.execBuffer=function(e){return this._transactions>0&&c.call(i),i.exec(e)},i};const{exec:s}=e;e.exec=function(e){return(0,n.default)(s.call(this).then((function(e){return Array.isArray(e)&&(e=(0,r.wrapMultiResult)(e)),e})),e)}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(8),n=s(5),o=s(3),i=s(7),a=s(1),c=s(0),l=s(11);function u(e,t){const s=r(t[0]),n=e._groupsBySlot[s];for(let s=1;s<t.length;s++)if(e._groupsBySlot[r(t[s])]!==n)return-1;return s}class f extends l.default{constructor(e){super(),this.redis=e,this.isPipeline=!0,this.replyPending=0,this._queue=[],this._result=[],this._transactions=0,this._shaToScript={},this.isCluster="Cluster"===this.redis.constructor.name||this.redis.isCluster,this.options=e.options,Object.keys(e.scriptsSet).forEach(t=>{const s=e.scriptsSet[t];this._shaToScript[s.sha]=s,this[t]=e[t],this[t+"Buffer"]=e[t+"Buffer"]}),e.addedBuiltinSet.forEach(t=>{this[t]=e[t],this[t+"Buffer"]=e[t+"Buffer"]}),this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t});const t=this;Object.defineProperty(this,"length",{get:function(){return t._queue.length}})}fillResult(e,t){if("exec"===this._queue[t].name&&Array.isArray(e[1])){const s=e[1].length;for(let r=0;r<s;r++){if(e[1][r]instanceof Error)continue;const n=this._queue[t-(s-r)];try{e[1][r]=n.transformReply(e[1][r])}catch(t){e[1][r]=t}}}if(this._result[t]=e,--this.replyPending)return;if(this.isCluster){let e,t=!0;for(let s=0;s<this._result.length;++s){const r=this._result[s][0],o=this._queue[s];if(r){if("exec"===o.name&&"EXECABORT Transaction discarded because of previous errors."===r.message)continue;if(e){if(e.name!==r.name||e.message!==r.message){t=!1;break}}else e={name:r.name,message:r.message}}else if(!o.inTransaction){if(!((0,n.exists)(o.name)&&(0,n.hasFlag)(o.name,"readonly"))){t=!1;break}}}if(e&&t){const t=this,s=e.message.split(" "),r=this._queue;let n=!1;this._queue=[];for(let e=0;e<r.length;++e){if(!("ASK"!==s[0]||n||"asking"===r[e].name||r[e-1]&&"asking"===r[e-1].name)){const e=new a.default("asking");e.ignore=!0,this.sendCommand(e)}r[e].initPromise(),this.sendCommand(r[e]),n=r[e].inTransaction}let o=!0;void 0===this.leftRedirections&&(this.leftRedirections={});const i=function(){t.exec()},c=this.redis;if(c.handleError(e,this.leftRedirections,{moved:function(e,r){t.preferKey=r,c.slots[s[1]]=[r],c._groupsBySlot[s[1]]=c._groupsIds[c.slots[s[1]].join(";")],c.refreshSlotsCache(),t.exec()},ask:function(e,s){t.preferKey=s,t.exec()},tryagain:i,clusterDown:i,connectionClosed:i,maxRedirections:()=>{o=!1},defaults:()=>{o=!1}}),o)return}}let s=0;for(let e=0;e<this._queue.length-s;++e)this._queue[e+s].ignore&&(s+=1),this._result[e]=this._result[e+s];this.resolve(this._result.slice(0,this._result.length-s))}sendCommand(e){this._transactions>0&&(e.inTransaction=!0);const t=this._queue.length;return e.pipelineIndex=t,e.promise.then(e=>{this.fillResult([null,e],t)}).catch(e=>{this.fillResult([e],t)}),this._queue.push(e),this}addBatch(e){let t,s,r;for(let n=0;n<e.length;++n)t=e[n],s=t[0],r=t.slice(1),this[s].apply(this,r);return this}}t.default=f;const h=f.prototype.multi;f.prototype.multi=function(){return this._transactions+=1,h.apply(this,arguments)};const p=f.prototype.execBuffer;f.prototype.execBuffer=(0,i.deprecate)((function(){return this._transactions>0&&(this._transactions-=1),p.apply(this,arguments)}),"Pipeline#execBuffer: Use Pipeline#exec instead"),f.prototype.exec=function(e){if(this.isCluster&&!this.redis.slots.length)return"wait"===this.redis.status&&this.redis.connect().catch(c.noop),e&&!this.nodeifiedPromise&&(this.nodeifiedPromise=!0,(0,o.default)(this.promise,e)),this.redis.delayUntilReady(t=>{t?this.reject(t):this.exec(e)}),this.promise;if(this._transactions>0)return this._transactions-=1,p.apply(this,arguments);let t;if(this.nodeifiedPromise||(this.nodeifiedPromise=!0,(0,o.default)(this.promise,e)),this._queue.length||this.resolve([]),this.isCluster){const e=[];for(let t=0;t<this._queue.length;t++){const s=this._queue[t].getKeys();if(s.length&&e.push(s[0]),s.length&&r.generateMulti(s)<0)return this.reject(new Error("All the keys in a pipeline command should belong to the same slot")),this.promise}if(e.length){if(t=u(this.redis,e),t<0)return this.reject(new Error("All keys in the pipeline should belong to the same slots allocation group")),this.promise}else t=16384*Math.random()|0}const s=this;return n(),this.promise;function n(){let e,r=s.replyPending=s._queue.length;s.isCluster&&(e={slot:t,redis:s.redis.connectionPool.nodes.all[s.preferKey]});let n,o="";const i={isPipeline:!0,destination:s.isCluster?e:{redis:s.redis},write(e){"string"!=typeof e?(n||(n=[]),o&&(n.push(Buffer.from(o,"utf8")),o=""),n.push(e)):o+=e,--r||(n?(o&&n.push(Buffer.from(o,"utf8")),i.destination.redis.stream.write(Buffer.concat(n))):i.destination.redis.stream.write(o),r=s._queue.length,o="",n=void 0)}};for(let t=0;t<s._queue.length;++t)s.redis.sendCommand(s._queue[t],i,e);return s.promise}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){Object.getOwnPropertyNames(t.prototype).forEach(s=>{Object.defineProperty(e.prototype,s,Object.getOwnPropertyDescriptor(t.prototype,s))})}},function(e,t){e.exports=require("tls")},function(e,t,s){"use strict";s(27).config();const r=new(s(31))({host:process.env.REDIS_HOST,port:process.env.REDIS_PORT,password:process.env.REDIS_PSW});e.exports=r},function(e,t,s){const r=s(28),n=s(29),o=s(17),i=s(18),a=s(30).version,c=/(?:^|^)\s*(?:export\s+)?([\w.-]+)(?:\s*=\s*?|:\s+?)(\s*'(?:\\'|[^'])*'|\s*"(?:\\"|[^"])*"|\s*`(?:\\`|[^`])*`|[^#\r\n]+)?\s*(?:#.*)?(?:$|$)/gm;function l(e){console.log(`[dotenv@${a}][DEBUG] ${e}`)}function u(e){return e&&e.DOTENV_KEY&&e.DOTENV_KEY.length>0?e.DOTENV_KEY:process.env.DOTENV_KEY&&process.env.DOTENV_KEY.length>0?process.env.DOTENV_KEY:""}function f(e,t){let s;try{s=new URL(t)}catch(e){if("ERR_INVALID_URL"===e.code){const e=new Error("INVALID_DOTENV_KEY: Wrong format. Must be in valid uri format like dotenv://:key_1234@dotenvx.com/vault/.env.vault?environment=development");throw e.code="INVALID_DOTENV_KEY",e}throw e}const r=s.password;if(!r){const e=new Error("INVALID_DOTENV_KEY: Missing key part");throw e.code="INVALID_DOTENV_KEY",e}const n=s.searchParams.get("environment");if(!n){const e=new Error("INVALID_DOTENV_KEY: Missing environment part");throw e.code="INVALID_DOTENV_KEY",e}const o="DOTENV_VAULT_"+n.toUpperCase(),i=e.parsed[o];if(!i){const e=new Error(`NOT_FOUND_DOTENV_ENVIRONMENT: Cannot locate environment ${o} in your .env.vault file.`);throw e.code="NOT_FOUND_DOTENV_ENVIRONMENT",e}return{ciphertext:i,key:r}}function h(e){let t=null;if(e&&e.path&&e.path.length>0)if(Array.isArray(e.path))for(const s of e.path)r.existsSync(s)&&(t=s.endsWith(".vault")?s:s+".vault");else t=e.path.endsWith(".vault")?e.path:e.path+".vault";else t=n.resolve(process.cwd(),".env.vault");return r.existsSync(t)?t:null}function p(e){return"~"===e[0]?n.join(o.homedir(),e.slice(1)):e}const d={configDotenv:function(e){const t=n.resolve(process.cwd(),".env");let s="utf8";const o=Boolean(e&&e.debug);e&&e.encoding?s=e.encoding:o&&l("No encoding is specified. UTF-8 is used by default");let i,a=[t];if(e&&e.path)if(Array.isArray(e.path)){a=[];for(const t of e.path)a.push(p(t))}else a=[p(e.path)];const c={};for(const t of a)try{const n=d.parse(r.readFileSync(t,{encoding:s}));d.populate(c,n,e)}catch(e){o&&l(`Failed to load ${t} ${e.message}`),i=e}let u=process.env;return e&&null!=e.processEnv&&(u=e.processEnv),d.populate(u,c,e),i?{parsed:c,error:i}:{parsed:c}},_configVault:function(e){var t;t="Loading env from encrypted .env.vault",console.log(`[dotenv@${a}][INFO] ${t}`);const s=d._parseVault(e);let r=process.env;return e&&null!=e.processEnv&&(r=e.processEnv),d.populate(r,s,e),{parsed:s}},_parseVault:function(e){const t=h(e),s=d.configDotenv({path:t});if(!s.parsed){const e=new Error(`MISSING_DATA: Cannot parse ${t} for an unknown reason`);throw e.code="MISSING_DATA",e}const r=u(e).split(","),n=r.length;let o;for(let e=0;e<n;e++)try{const t=f(s,r[e].trim());o=d.decrypt(t.ciphertext,t.key);break}catch(t){if(e+1>=n)throw t}return d.parse(o)},config:function(e){if(0===u(e).length)return d.configDotenv(e);const t=h(e);return t?d._configVault(e):(s=`You set DOTENV_KEY but you are missing a .env.vault file at ${t}. Did you forget to build it?`,console.log(`[dotenv@${a}][WARN] ${s}`),d.configDotenv(e));var s},decrypt:function(e,t){const s=Buffer.from(t.slice(-64),"hex");let r=Buffer.from(e,"base64");const n=r.subarray(0,12),o=r.subarray(-16);r=r.subarray(12,-16);try{const e=i.createDecipheriv("aes-256-gcm",s,n);return e.setAuthTag(o),`${e.update(r)}${e.final()}`}catch(e){const t=e instanceof RangeError,s="Invalid key length"===e.message,r="Unsupported state or unable to authenticate data"===e.message;if(t||s){const e=new Error("INVALID_DOTENV_KEY: It must be 64 characters long (or more)");throw e.code="INVALID_DOTENV_KEY",e}if(r){const e=new Error("DECRYPTION_FAILED: Please check your DOTENV_KEY");throw e.code="DECRYPTION_FAILED",e}throw e}},parse:function(e){const t={};let s,r=e.toString();for(r=r.replace(/\r\n?/gm,"\n");null!=(s=c.exec(r));){const e=s[1];let r=s[2]||"";r=r.trim();const n=r[0];r=r.replace(/^(['"`])([\s\S]*)\1$/gm,"$2"),'"'===n&&(r=r.replace(/\\n/g,"\n"),r=r.replace(/\\r/g,"\r")),t[e]=r}return t},populate:function(e,t,s={}){const r=Boolean(s&&s.debug),n=Boolean(s&&s.override);if("object"!=typeof t){const e=new Error("OBJECT_REQUIRED: Please check the processEnv argument being passed to populate");throw e.code="OBJECT_REQUIRED",e}for(const s of Object.keys(t))Object.prototype.hasOwnProperty.call(e,s)?(!0===n&&(e[s]=t[s]),r&&l(!0===n?`"${s}" is already defined and WAS overwritten`:`"${s}" is already defined and was NOT overwritten`)):e[s]=t[s]}};e.exports.configDotenv=d.configDotenv,e.exports._configVault=d._configVault,e.exports._parseVault=d._parseVault,e.exports.config=d.config,e.exports.decrypt=d.decrypt,e.exports.parse=d.parse,e.exports.populate=d.populate,e.exports=d},function(e,t){e.exports=require("fs")},function(e,t){e.exports=require("path")},function(e){e.exports=JSON.parse('{"name":"dotenv","version":"16.4.5","description":"Loads environment variables from .env file","main":"lib/main.js","types":"lib/main.d.ts","exports":{".":{"types":"./lib/main.d.ts","require":"./lib/main.js","default":"./lib/main.js"},"./config":"./config.js","./config.js":"./config.js","./lib/env-options":"./lib/env-options.js","./lib/env-options.js":"./lib/env-options.js","./lib/cli-options":"./lib/cli-options.js","./lib/cli-options.js":"./lib/cli-options.js","./package.json":"./package.json"},"scripts":{"dts-check":"tsc --project tests/types/tsconfig.json","lint":"standard","lint-readme":"standard-markdown","pretest":"npm run lint && npm run dts-check","test":"tap tests/*.js --100 -Rspec","test:coverage":"tap --coverage-report=lcov","prerelease":"npm test","release":"standard-version"},"repository":{"type":"git","url":"git://github.com/motdotla/dotenv.git"},"funding":"https://dotenvx.com","keywords":["dotenv","env",".env","environment","variables","config","settings"],"readmeFilename":"README.md","license":"BSD-2-Clause","devDependencies":{"@definitelytyped/dtslint":"^0.0.133","@types/node":"^18.11.3","decache":"^4.6.1","sinon":"^14.0.1","standard":"^17.0.0","standard-markdown":"^7.1.0","standard-version":"^9.5.0","tap":"^16.3.0","tar":"^6.1.11","typescript":"^4.8.4"},"engines":{"node":">=12"},"browser":{"fs":false}}')},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.print=t.ReplyError=t.SentinelIterator=t.SentinelConnector=t.AbstractConnector=t.Pipeline=t.ScanStream=t.Command=t.Cluster=t.Redis=t.default=void 0,t=e.exports=s(2).default;var r=s(2);Object.defineProperty(t,"default",{enumerable:!0,get:function(){return r.default}});var n=s(2);Object.defineProperty(t,"Redis",{enumerable:!0,get:function(){return n.default}});var o=s(19);Object.defineProperty(t,"Cluster",{enumerable:!0,get:function(){return o.default}});var i=s(1);Object.defineProperty(t,"Command",{enumerable:!0,get:function(){return i.default}});var a=s(10);Object.defineProperty(t,"ScanStream",{enumerable:!0,get:function(){return a.default}});var c=s(23);Object.defineProperty(t,"Pipeline",{enumerable:!0,get:function(){return c.default}});var l=s(15);Object.defineProperty(t,"AbstractConnector",{enumerable:!0,get:function(){return l.default}});var u=s(16);Object.defineProperty(t,"SentinelConnector",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(t,"SentinelIterator",{enumerable:!0,get:function(){return u.SentinelIterator}}),t.ReplyError=s(4).ReplyError,Object.defineProperty(t,"Promise",{get:()=>(console.warn("ioredis v5 does not support plugging third-party Promise library anymore. Native Promise will be used."),Promise),set(e){console.warn("ioredis v5 does not support plugging third-party Promise library anymore. Native Promise will be used.")}}),t.print=function(e,t){e?console.log("Error: "+e):console.log("Reply: "+t)}},function(e){e.exports=JSON.parse('{"acl":{"arity":-2,"flags":[],"keyStart":0,"keyStop":0,"step":0},"append":{"arity":3,"flags":["write","denyoom","fast"],"keyStart":1,"keyStop":1,"step":1},"asking":{"arity":1,"flags":["fast"],"keyStart":0,"keyStop":0,"step":0},"auth":{"arity":-2,"flags":["noscript","loading","stale","fast","no_auth","allow_busy"],"keyStart":0,"keyStop":0,"step":0},"bgrewriteaof":{"arity":1,"flags":["admin","noscript","no_async_loading"],"keyStart":0,"keyStop":0,"step":0},"bgsave":{"arity":-1,"flags":["admin","noscript","no_async_loading"],"keyStart":0,"keyStop":0,"step":0},"bitcount":{"arity":-2,"flags":["readonly"],"keyStart":1,"keyStop":1,"step":1},"bitfield":{"arity":-2,"flags":["write","denyoom"],"keyStart":1,"keyStop":1,"step":1},"bitfield_ro":{"arity":-2,"flags":["readonly","fast"],"keyStart":1,"keyStop":1,"step":1},"bitop":{"arity":-4,"flags":["write","denyoom"],"keyStart":2,"keyStop":-1,"step":1},"bitpos":{"arity":-3,"flags":["readonly"],"keyStart":1,"keyStop":1,"step":1},"blmove":{"arity":6,"flags":["write","denyoom","noscript","blocking"],"keyStart":1,"keyStop":2,"step":1},"blmpop":{"arity":-5,"flags":["write","blocking","movablekeys"],"keyStart":0,"keyStop":0,"step":0},"blpop":{"arity":-3,"flags":["write","noscript","blocking"],"keyStart":1,"keyStop":-2,"step":1},"brpop":{"arity":-3,"flags":["write","noscript","blocking"],"keyStart":1,"keyStop":-2,"step":1},"brpoplpush":{"arity":4,"flags":["write","denyoom","noscript","blocking"],"keyStart":1,"keyStop":2,"step":1},"bzmpop":{"arity":-5,"flags":["write","blocking","movablekeys"],"keyStart":0,"keyStop":0,"step":0},"bzpopmax":{"arity":-3,"flags":["write","noscript","blocking","fast"],"keyStart":1,"keyStop":-2,"step":1},"bzpopmin":{"arity":-3,"flags":["write","noscript","blocking","fast"],"keyStart":1,"keyStop":-2,"step":1},"client":{"arity":-2,"flags":[],"keyStart":0,"keyStop":0,"step":0},"cluster":{"arity":-2,"flags":[],"keyStart":0,"keyStop":0,"step":0},"command":{"arity":-1,"flags":["loading","stale"],"keyStart":0,"keyStop":0,"step":0},"config":{"arity":-2,"flags":[],"keyStart":0,"keyStop":0,"step":0},"copy":{"arity":-3,"flags":["write","denyoom"],"keyStart":1,"keyStop":2,"step":1},"dbsize":{"arity":1,"flags":["readonly","fast"],"keyStart":0,"keyStop":0,"step":0},"debug":{"arity":-2,"flags":["admin","noscript","loading","stale"],"keyStart":0,"keyStop":0,"step":0},"decr":{"arity":2,"flags":["write","denyoom","fast"],"keyStart":1,"keyStop":1,"step":1},"decrby":{"arity":3,"flags":["write","denyoom","fast"],"keyStart":1,"keyStop":1,"step":1},"del":{"arity":-2,"flags":["write"],"keyStart":1,"keyStop":-1,"step":1},"discard":{"arity":1,"flags":["noscript","loading","stale","fast","allow_busy"],"keyStart":0,"keyStop":0,"step":0},"dump":{"arity":2,"flags":["readonly"],"keyStart":1,"keyStop":1,"step":1},"echo":{"arity":2,"flags":["fast"],"keyStart":0,"keyStop":0,"step":0},"eval":{"arity":-3,"flags":["noscript","stale","skip_monitor","no_mandatory_keys","movablekeys"],"keyStart":0,"keyStop":0,"step":0},"eval_ro":{"arity":-3,"flags":["readonly","noscript","stale","skip_monitor","no_mandatory_keys","movablekeys"],"keyStart":0,"keyStop":0,"step":0},"evalsha":{"arity":-3,"flags":["noscript","stale","skip_monitor","no_mandatory_keys","movablekeys"],"keyStart":0,"keyStop":0,"step":0},"evalsha_ro":{"arity":-3,"flags":["readonly","noscript","stale","skip_monitor","no_mandatory_keys","movablekeys"],"keyStart":0,"keyStop":0,"step":0},"exec":{"arity":1,"flags":["noscript","loading","stale","skip_slowlog"],"keyStart":0,"keyStop":0,"step":0},"exists":{"arity":-2,"flags":["readonly","fast"],"keyStart":1,"keyStop":-1,"step":1},"expire":{"arity":-3,"flags":["write","fast"],"keyStart":1,"keyStop":1,"step":1},"expireat":{"arity":-3,"flags":["write","fast"],"keyStart":1,"keyStop":1,"step":1},"expiretime":{"arity":2,"flags":["readonly","fast"],"keyStart":1,"keyStop":1,"step":1},"failover":{"arity":-1,"flags":["admin","noscript","stale"],"keyStart":0,"keyStop":0,"step":0},"fcall":{"arity":-3,"flags":["noscript","stale","skip_monitor","no_mandatory_keys","movablekeys"],"keyStart":0,"keyStop":0,"step":0},"fcall_ro":{"arity":-3,"flags":["readonly","noscript","stale","skip_monitor","no_mandatory_keys","movablekeys"],"keyStart":0,"keyStop":0,"step":0},"flushall":{"arity":-1,"flags":["write"],"keyStart":0,"keyStop":0,"step":0},"flushdb":{"arity":-1,"flags":["write"],"keyStart":0,"keyStop":0,"step":0},"function":{"arity":-2,"flags":[],"keyStart":0,"keyStop":0,"step":0},"geoadd":{"arity":-5,"flags":["write","denyoom"],"keyStart":1,"keyStop":1,"step":1},"geodist":{"arity":-4,"flags":["readonly"],"keyStart":1,"keyStop":1,"step":1},"geohash":{"arity":-2,"flags":["readonly"],"keyStart":1,"keyStop":1,"step":1},"geopos":{"arity":-2,"flags":["readonly"],"keyStart":1,"keyStop":1,"step":1},"georadius":{"arity":-6,"flags":["write","denyoom","movablekeys"],"keyStart":1,"keyStop":1,"step":1},"georadius_ro":{"arity":-6,"flags":["readonly"],"keyStart":1,"keyStop":1,"step":1},"georadiusbymember":{"arity":-5,"flags":["write","denyoom","movablekeys"],"keyStart":1,"keyStop":1,"step":1},"georadiusbymember_ro":{"arity":-5,"flags":["readonly"],"keyStart":1,"keyStop":1,"step":1},"geosearch":{"arity":-7,"flags":["readonly"],"keyStart":1,"keyStop":1,"step":1},"geosearchstore":{"arity":-8,"flags":["write","denyoom"],"keyStart":1,"keyStop":2,"step":1},"get":{"arity":2,"flags":["readonly","fast"],"keyStart":1,"keyStop":1,"step":1},"getbit":{"arity":3,"flags":["readonly","fast"],"keyStart":1,"keyStop":1,"step":1},"getdel":{"arity":2,"flags":["write","fast"],"keyStart":1,"keyStop":1,"step":1},"getex":{"arity":-2,"flags":["write","fast"],"keyStart":1,"keyStop":1,"step":1},"getrange":{"arity":4,"flags":["readonly"],"keyStart":1,"keyStop":1,"step":1},"getset":{"arity":3,"flags":["write","denyoom","fast"],"keyStart":1,"keyStop":1,"step":1},"hdel":{"arity":-3,"flags":["write","fast"],"keyStart":1,"keyStop":1,"step":1},"hello":{"arity":-1,"flags":["noscript","loading","stale","fast","no_auth","allow_busy"],"keyStart":0,"keyStop":0,"step":0},"hexists":{"arity":3,"flags":["readonly","fast"],"keyStart":1,"keyStop":1,"step":1},"hget":{"arity":3,"flags":["readonly","fast"],"keyStart":1,"keyStop":1,"step":1},"hgetall":{"arity":2,"flags":["readonly"],"keyStart":1,"keyStop":1,"step":1},"hincrby":{"arity":4,"flags":["write","denyoom","fast"],"keyStart":1,"keyStop":1,"step":1},"hincrbyfloat":{"arity":4,"flags":["write","denyoom","fast"],"keyStart":1,"keyStop":1,"step":1},"hkeys":{"arity":2,"flags":["readonly"],"keyStart":1,"keyStop":1,"step":1},"hlen":{"arity":2,"flags":["readonly","fast"],"keyStart":1,"keyStop":1,"step":1},"hmget":{"arity":-3,"flags":["readonly","fast"],"keyStart":1,"keyStop":1,"step":1},"hmset":{"arity":-4,"flags":["write","denyoom","fast"],"keyStart":1,"keyStop":1,"step":1},"hrandfield":{"arity":-2,"flags":["readonly"],"keyStart":1,"keyStop":1,"step":1},"hscan":{"arity":-3,"flags":["readonly"],"keyStart":1,"keyStop":1,"step":1},"hset":{"arity":-4,"flags":["write","denyoom","fast"],"keyStart":1,"keyStop":1,"step":1},"hsetnx":{"arity":4,"flags":["write","denyoom","fast"],"keyStart":1,"keyStop":1,"step":1},"hstrlen":{"arity":3,"flags":["readonly","fast"],"keyStart":1,"keyStop":1,"step":1},"hvals":{"arity":2,"flags":["readonly"],"keyStart":1,"keyStop":1,"step":1},"incr":{"arity":2,"flags":["write","denyoom","fast"],"keyStart":1,"keyStop":1,"step":1},"incrby":{"arity":3,"flags":["write","denyoom","fast"],"keyStart":1,"keyStop":1,"step":1},"incrbyfloat":{"arity":3,"flags":["write","denyoom","fast"],"keyStart":1,"keyStop":1,"step":1},"info":{"arity":-1,"flags":["loading","stale"],"keyStart":0,"keyStop":0,"step":0},"keys":{"arity":2,"flags":["readonly"],"keyStart":0,"keyStop":0,"step":0},"lastsave":{"arity":1,"flags":["loading","stale","fast"],"keyStart":0,"keyStop":0,"step":0},"latency":{"arity":-2,"flags":[],"keyStart":0,"keyStop":0,"step":0},"lcs":{"arity":-3,"flags":["readonly"],"keyStart":1,"keyStop":2,"step":1},"lindex":{"arity":3,"flags":["readonly"],"keyStart":1,"keyStop":1,"step":1},"linsert":{"arity":5,"flags":["write","denyoom"],"keyStart":1,"keyStop":1,"step":1},"llen":{"arity":2,"flags":["readonly","fast"],"keyStart":1,"keyStop":1,"step":1},"lmove":{"arity":5,"flags":["write","denyoom"],"keyStart":1,"keyStop":2,"step":1},"lmpop":{"arity":-4,"flags":["write","movablekeys"],"keyStart":0,"keyStop":0,"step":0},"lolwut":{"arity":-1,"flags":["readonly","fast"],"keyStart":0,"keyStop":0,"step":0},"lpop":{"arity":-2,"flags":["write","fast"],"keyStart":1,"keyStop":1,"step":1},"lpos":{"arity":-3,"flags":["readonly"],"keyStart":1,"keyStop":1,"step":1},"lpush":{"arity":-3,"flags":["write","denyoom","fast"],"keyStart":1,"keyStop":1,"step":1},"lpushx":{"arity":-3,"flags":["write","denyoom","fast"],"keyStart":1,"keyStop":1,"step":1},"lrange":{"arity":4,"flags":["readonly"],"keyStart":1,"keyStop":1,"step":1},"lrem":{"arity":4,"flags":["write"],"keyStart":1,"keyStop":1,"step":1},"lset":{"arity":4,"flags":["write","denyoom"],"keyStart":1,"keyStop":1,"step":1},"ltrim":{"arity":4,"flags":["write"],"keyStart":1,"keyStop":1,"step":1},"memory":{"arity":-2,"flags":[],"keyStart":0,"keyStop":0,"step":0},"mget":{"arity":-2,"flags":["readonly","fast"],"keyStart":1,"keyStop":-1,"step":1},"migrate":{"arity":-6,"flags":["write","movablekeys"],"keyStart":3,"keyStop":3,"step":1},"module":{"arity":-2,"flags":[],"keyStart":0,"keyStop":0,"step":0},"monitor":{"arity":1,"flags":["admin","noscript","loading","stale"],"keyStart":0,"keyStop":0,"step":0},"move":{"arity":3,"flags":["write","fast"],"keyStart":1,"keyStop":1,"step":1},"mset":{"arity":-3,"flags":["write","denyoom"],"keyStart":1,"keyStop":-1,"step":2},"msetnx":{"arity":-3,"flags":["write","denyoom"],"keyStart":1,"keyStop":-1,"step":2},"multi":{"arity":1,"flags":["noscript","loading","stale","fast","allow_busy"],"keyStart":0,"keyStop":0,"step":0},"object":{"arity":-2,"flags":[],"keyStart":0,"keyStop":0,"step":0},"persist":{"arity":2,"flags":["write","fast"],"keyStart":1,"keyStop":1,"step":1},"pexpire":{"arity":-3,"flags":["write","fast"],"keyStart":1,"keyStop":1,"step":1},"pexpireat":{"arity":-3,"flags":["write","fast"],"keyStart":1,"keyStop":1,"step":1},"pexpiretime":{"arity":2,"flags":["readonly","fast"],"keyStart":1,"keyStop":1,"step":1},"pfadd":{"arity":-2,"flags":["write","denyoom","fast"],"keyStart":1,"keyStop":1,"step":1},"pfcount":{"arity":-2,"flags":["readonly"],"keyStart":1,"keyStop":-1,"step":1},"pfdebug":{"arity":3,"flags":["write","denyoom","admin"],"keyStart":2,"keyStop":2,"step":1},"pfmerge":{"arity":-2,"flags":["write","denyoom"],"keyStart":1,"keyStop":-1,"step":1},"pfselftest":{"arity":1,"flags":["admin"],"keyStart":0,"keyStop":0,"step":0},"ping":{"arity":-1,"flags":["fast"],"keyStart":0,"keyStop":0,"step":0},"psetex":{"arity":4,"flags":["write","denyoom"],"keyStart":1,"keyStop":1,"step":1},"psubscribe":{"arity":-2,"flags":["pubsub","noscript","loading","stale"],"keyStart":0,"keyStop":0,"step":0},"psync":{"arity":-3,"flags":["admin","noscript","no_async_loading","no_multi"],"keyStart":0,"keyStop":0,"step":0},"pttl":{"arity":2,"flags":["readonly","fast"],"keyStart":1,"keyStop":1,"step":1},"publish":{"arity":3,"flags":["pubsub","loading","stale","fast"],"keyStart":0,"keyStop":0,"step":0},"pubsub":{"arity":-2,"flags":[],"keyStart":0,"keyStop":0,"step":0},"punsubscribe":{"arity":-1,"flags":["pubsub","noscript","loading","stale"],"keyStart":0,"keyStop":0,"step":0},"quit":{"arity":-1,"flags":["noscript","loading","stale","fast","no_auth","allow_busy"],"keyStart":0,"keyStop":0,"step":0},"randomkey":{"arity":1,"flags":["readonly"],"keyStart":0,"keyStop":0,"step":0},"readonly":{"arity":1,"flags":["loading","stale","fast"],"keyStart":0,"keyStop":0,"step":0},"readwrite":{"arity":1,"flags":["loading","stale","fast"],"keyStart":0,"keyStop":0,"step":0},"rename":{"arity":3,"flags":["write"],"keyStart":1,"keyStop":2,"step":1},"renamenx":{"arity":3,"flags":["write","fast"],"keyStart":1,"keyStop":2,"step":1},"replconf":{"arity":-1,"flags":["admin","noscript","loading","stale","allow_busy"],"keyStart":0,"keyStop":0,"step":0},"replicaof":{"arity":3,"flags":["admin","noscript","stale","no_async_loading"],"keyStart":0,"keyStop":0,"step":0},"reset":{"arity":1,"flags":["noscript","loading","stale","fast","no_auth","allow_busy"],"keyStart":0,"keyStop":0,"step":0},"restore":{"arity":-4,"flags":["write","denyoom"],"keyStart":1,"keyStop":1,"step":1},"restore-asking":{"arity":-4,"flags":["write","denyoom","asking"],"keyStart":1,"keyStop":1,"step":1},"role":{"arity":1,"flags":["noscript","loading","stale","fast"],"keyStart":0,"keyStop":0,"step":0},"rpop":{"arity":-2,"flags":["write","fast"],"keyStart":1,"keyStop":1,"step":1},"rpoplpush":{"arity":3,"flags":["write","denyoom"],"keyStart":1,"keyStop":2,"step":1},"rpush":{"arity":-3,"flags":["write","denyoom","fast"],"keyStart":1,"keyStop":1,"step":1},"rpushx":{"arity":-3,"flags":["write","denyoom","fast"],"keyStart":1,"keyStop":1,"step":1},"sadd":{"arity":-3,"flags":["write","denyoom","fast"],"keyStart":1,"keyStop":1,"step":1},"save":{"arity":1,"flags":["admin","noscript","no_async_loading","no_multi"],"keyStart":0,"keyStop":0,"step":0},"scan":{"arity":-2,"flags":["readonly"],"keyStart":0,"keyStop":0,"step":0},"scard":{"arity":2,"flags":["readonly","fast"],"keyStart":1,"keyStop":1,"step":1},"script":{"arity":-2,"flags":[],"keyStart":0,"keyStop":0,"step":0},"sdiff":{"arity":-2,"flags":["readonly"],"keyStart":1,"keyStop":-1,"step":1},"sdiffstore":{"arity":-3,"flags":["write","denyoom"],"keyStart":1,"keyStop":-1,"step":1},"select":{"arity":2,"flags":["loading","stale","fast"],"keyStart":0,"keyStop":0,"step":0},"set":{"arity":-3,"flags":["write","denyoom"],"keyStart":1,"keyStop":1,"step":1},"setbit":{"arity":4,"flags":["write","denyoom"],"keyStart":1,"keyStop":1,"step":1},"setex":{"arity":4,"flags":["write","denyoom"],"keyStart":1,"keyStop":1,"step":1},"setnx":{"arity":3,"flags":["write","denyoom","fast"],"keyStart":1,"keyStop":1,"step":1},"setrange":{"arity":4,"flags":["write","denyoom"],"keyStart":1,"keyStop":1,"step":1},"shutdown":{"arity":-1,"flags":["admin","noscript","loading","stale","no_multi","allow_busy"],"keyStart":0,"keyStop":0,"step":0},"sinter":{"arity":-2,"flags":["readonly"],"keyStart":1,"keyStop":-1,"step":1},"sintercard":{"arity":-3,"flags":["readonly","movablekeys"],"keyStart":0,"keyStop":0,"step":0},"sinterstore":{"arity":-3,"flags":["write","denyoom"],"keyStart":1,"keyStop":-1,"step":1},"sismember":{"arity":3,"flags":["readonly","fast"],"keyStart":1,"keyStop":1,"step":1},"slaveof":{"arity":3,"flags":["admin","noscript","stale","no_async_loading"],"keyStart":0,"keyStop":0,"step":0},"slowlog":{"arity":-2,"flags":[],"keyStart":0,"keyStop":0,"step":0},"smembers":{"arity":2,"flags":["readonly"],"keyStart":1,"keyStop":1,"step":1},"smismember":{"arity":-3,"flags":["readonly","fast"],"keyStart":1,"keyStop":1,"step":1},"smove":{"arity":4,"flags":["write","fast"],"keyStart":1,"keyStop":2,"step":1},"sort":{"arity":-2,"flags":["write","denyoom","movablekeys"],"keyStart":1,"keyStop":1,"step":1},"sort_ro":{"arity":-2,"flags":["readonly","movablekeys"],"keyStart":1,"keyStop":1,"step":1},"spop":{"arity":-2,"flags":["write","fast"],"keyStart":1,"keyStop":1,"step":1},"spublish":{"arity":3,"flags":["pubsub","loading","stale","fast"],"keyStart":1,"keyStop":1,"step":1},"srandmember":{"arity":-2,"flags":["readonly"],"keyStart":1,"keyStop":1,"step":1},"srem":{"arity":-3,"flags":["write","fast"],"keyStart":1,"keyStop":1,"step":1},"sscan":{"arity":-3,"flags":["readonly"],"keyStart":1,"keyStop":1,"step":1},"ssubscribe":{"arity":-2,"flags":["pubsub","noscript","loading","stale"],"keyStart":1,"keyStop":-1,"step":1},"strlen":{"arity":2,"flags":["readonly","fast"],"keyStart":1,"keyStop":1,"step":1},"subscribe":{"arity":-2,"flags":["pubsub","noscript","loading","stale"],"keyStart":0,"keyStop":0,"step":0},"substr":{"arity":4,"flags":["readonly"],"keyStart":1,"keyStop":1,"step":1},"sunion":{"arity":-2,"flags":["readonly"],"keyStart":1,"keyStop":-1,"step":1},"sunionstore":{"arity":-3,"flags":["write","denyoom"],"keyStart":1,"keyStop":-1,"step":1},"sunsubscribe":{"arity":-1,"flags":["pubsub","noscript","loading","stale"],"keyStart":1,"keyStop":-1,"step":1},"swapdb":{"arity":3,"flags":["write","fast"],"keyStart":0,"keyStop":0,"step":0},"sync":{"arity":1,"flags":["admin","noscript","no_async_loading","no_multi"],"keyStart":0,"keyStop":0,"step":0},"time":{"arity":1,"flags":["loading","stale","fast"],"keyStart":0,"keyStop":0,"step":0},"touch":{"arity":-2,"flags":["readonly","fast"],"keyStart":1,"keyStop":-1,"step":1},"ttl":{"arity":2,"flags":["readonly","fast"],"keyStart":1,"keyStop":1,"step":1},"type":{"arity":2,"flags":["readonly","fast"],"keyStart":1,"keyStop":1,"step":1},"unlink":{"arity":-2,"flags":["write","fast"],"keyStart":1,"keyStop":-1,"step":1},"unsubscribe":{"arity":-1,"flags":["pubsub","noscript","loading","stale"],"keyStart":0,"keyStop":0,"step":0},"unwatch":{"arity":1,"flags":["noscript","loading","stale","fast","allow_busy"],"keyStart":0,"keyStop":0,"step":0},"wait":{"arity":3,"flags":["noscript"],"keyStart":0,"keyStop":0,"step":0},"watch":{"arity":-2,"flags":["noscript","loading","stale","fast","allow_busy"],"keyStart":1,"keyStop":-1,"step":1},"xack":{"arity":-4,"flags":["write","fast"],"keyStart":1,"keyStop":1,"step":1},"xadd":{"arity":-5,"flags":["write","denyoom","fast"],"keyStart":1,"keyStop":1,"step":1},"xautoclaim":{"arity":-6,"flags":["write","fast"],"keyStart":1,"keyStop":1,"step":1},"xclaim":{"arity":-6,"flags":["write","fast"],"keyStart":1,"keyStop":1,"step":1},"xdel":{"arity":-3,"flags":["write","fast"],"keyStart":1,"keyStop":1,"step":1},"xgroup":{"arity":-2,"flags":[],"keyStart":0,"keyStop":0,"step":0},"xinfo":{"arity":-2,"flags":[],"keyStart":0,"keyStop":0,"step":0},"xlen":{"arity":2,"flags":["readonly","fast"],"keyStart":1,"keyStop":1,"step":1},"xpending":{"arity":-3,"flags":["readonly"],"keyStart":1,"keyStop":1,"step":1},"xrange":{"arity":-4,"flags":["readonly"],"keyStart":1,"keyStop":1,"step":1},"xread":{"arity":-4,"flags":["readonly","blocking","movablekeys"],"keyStart":0,"keyStop":0,"step":0},"xreadgroup":{"arity":-7,"flags":["write","blocking","movablekeys"],"keyStart":0,"keyStop":0,"step":0},"xrevrange":{"arity":-4,"flags":["readonly"],"keyStart":1,"keyStop":1,"step":1},"xsetid":{"arity":-3,"flags":["write","denyoom","fast"],"keyStart":1,"keyStop":1,"step":1},"xtrim":{"arity":-4,"flags":["write"],"keyStart":1,"keyStop":1,"step":1},"zadd":{"arity":-4,"flags":["write","denyoom","fast"],"keyStart":1,"keyStop":1,"step":1},"zcard":{"arity":2,"flags":["readonly","fast"],"keyStart":1,"keyStop":1,"step":1},"zcount":{"arity":4,"flags":["readonly","fast"],"keyStart":1,"keyStop":1,"step":1},"zdiff":{"arity":-3,"flags":["readonly","movablekeys"],"keyStart":0,"keyStop":0,"step":0},"zdiffstore":{"arity":-4,"flags":["write","denyoom","movablekeys"],"keyStart":1,"keyStop":1,"step":1},"zincrby":{"arity":4,"flags":["write","denyoom","fast"],"keyStart":1,"keyStop":1,"step":1},"zinter":{"arity":-3,"flags":["readonly","movablekeys"],"keyStart":0,"keyStop":0,"step":0},"zintercard":{"arity":-3,"flags":["readonly","movablekeys"],"keyStart":0,"keyStop":0,"step":0},"zinterstore":{"arity":-4,"flags":["write","denyoom","movablekeys"],"keyStart":1,"keyStop":1,"step":1},"zlexcount":{"arity":4,"flags":["readonly","fast"],"keyStart":1,"keyStop":1,"step":1},"zmpop":{"arity":-4,"flags":["write","movablekeys"],"keyStart":0,"keyStop":0,"step":0},"zmscore":{"arity":-3,"flags":["readonly","fast"],"keyStart":1,"keyStop":1,"step":1},"zpopmax":{"arity":-2,"flags":["write","fast"],"keyStart":1,"keyStop":1,"step":1},"zpopmin":{"arity":-2,"flags":["write","fast"],"keyStart":1,"keyStop":1,"step":1},"zrandmember":{"arity":-2,"flags":["readonly"],"keyStart":1,"keyStop":1,"step":1},"zrange":{"arity":-4,"flags":["readonly"],"keyStart":1,"keyStop":1,"step":1},"zrangebylex":{"arity":-4,"flags":["readonly"],"keyStart":1,"keyStop":1,"step":1},"zrangebyscore":{"arity":-4,"flags":["readonly"],"keyStart":1,"keyStop":1,"step":1},"zrangestore":{"arity":-5,"flags":["write","denyoom"],"keyStart":1,"keyStop":2,"step":1},"zrank":{"arity":3,"flags":["readonly","fast"],"keyStart":1,"keyStop":1,"step":1},"zrem":{"arity":-3,"flags":["write","fast"],"keyStart":1,"keyStop":1,"step":1},"zremrangebylex":{"arity":4,"flags":["write"],"keyStart":1,"keyStop":1,"step":1},"zremrangebyrank":{"arity":4,"flags":["write"],"keyStart":1,"keyStop":1,"step":1},"zremrangebyscore":{"arity":4,"flags":["write"],"keyStart":1,"keyStop":1,"step":1},"zrevrange":{"arity":-4,"flags":["readonly"],"keyStart":1,"keyStop":1,"step":1},"zrevrangebylex":{"arity":-4,"flags":["readonly"],"keyStart":1,"keyStop":1,"step":1},"zrevrangebyscore":{"arity":-4,"flags":["readonly"],"keyStart":1,"keyStop":1,"step":1},"zrevrank":{"arity":3,"flags":["readonly","fast"],"keyStart":1,"keyStop":1,"step":1},"zscan":{"arity":-3,"flags":["readonly"],"keyStart":1,"keyStop":1,"step":1},"zscore":{"arity":3,"flags":["readonly","fast"],"keyStart":1,"keyStop":1,"step":1},"zunion":{"arity":-3,"flags":["readonly","movablekeys"],"keyStart":0,"keyStop":0,"step":0},"zunionstore":{"arity":-4,"flags":["write","denyoom","movablekeys"],"keyStart":1,"keyStop":1,"step":1}}')},function(e,t,s){"use strict";let r;function n(e,s){try{const e=r;return r=null,e.apply(this,arguments)}catch(e){return t.errorObj.e=e,t.errorObj}}Object.defineProperty(t,"__esModule",{value:!0}),t.tryCatch=t.errorObj=void 0,t.errorObj={e:{}},t.tryCatch=function(e){return r=e,n}},function(e,t,s){"use strict";const r=s(20),n=s(7);function o(e){Object.defineProperty(this,"message",{value:e||"",configurable:!0,writable:!0}),Error.captureStackTrace(this,this.constructor)}function i(e,t,s){r(t),r.strictEqual(typeof s,"number"),Object.defineProperty(this,"message",{value:e||"",configurable:!0,writable:!0});const n=Error.stackTraceLimit;Error.stackTraceLimit=2,Error.captureStackTrace(this,this.constructor),Error.stackTraceLimit=n,this.offset=s,this.buffer=t}function a(e){Object.defineProperty(this,"message",{value:e||"",configurable:!0,writable:!0});const t=Error.stackTraceLimit;Error.stackTraceLimit=2,Error.captureStackTrace(this,this.constructor),Error.stackTraceLimit=t}function c(e){Object.defineProperty(this,"message",{value:e||"",configurable:!0,writable:!0}),Error.captureStackTrace(this,this.constructor)}function l(e){Object.defineProperty(this,"message",{value:e||"",configurable:!0,writable:!0}),Error.captureStackTrace(this,this.constructor)}n.inherits(o,Error),Object.defineProperty(o.prototype,"name",{value:"RedisError",configurable:!0,writable:!0}),n.inherits(i,o),Object.defineProperty(i.prototype,"name",{value:"ParserError",configurable:!0,writable:!0}),n.inherits(a,o),Object.defineProperty(a.prototype,"name",{value:"ReplyError",configurable:!0,writable:!0}),n.inherits(c,o),Object.defineProperty(c.prototype,"name",{value:"AbortError",configurable:!0,writable:!0}),n.inherits(l,c),Object.defineProperty(l.prototype,"name",{value:"InterruptError",configurable:!0,writable:!0}),e.exports={RedisError:o,ParserError:i,ReplyError:a,AbortError:c,InterruptError:l}},function(e,t,s){"use strict";const r=s(20);class n extends Error{get name(){return this.constructor.name}}class o extends n{get name(){return this.constructor.name}}e.exports={RedisError:n,ParserError:class extends n{constructor(e,t,s){r(t),r.strictEqual(typeof s,"number");const n=Error.stackTraceLimit;Error.stackTraceLimit=2,super(e),Error.stackTraceLimit=n,this.offset=s,this.buffer=t}get name(){return this.constructor.name}},ReplyError:class extends n{constructor(e){const t=Error.stackTraceLimit;Error.stackTraceLimit=2,super(e),Error.stackTraceLimit=t}get name(){return this.constructor.name}},AbortError:o,InterruptError:class extends o{get name(){return this.constructor.name}}}},function(e,t){e.exports=require("url")},function(e,t){var s=/^(?:0|[1-9]\d*)$/;function r(e,t,s){switch(s.length){case 0:return e.call(t);case 1:return e.call(t,s[0]);case 2:return e.call(t,s[0],s[1]);case 3:return e.call(t,s[0],s[1],s[2])}return e.apply(t,s)}var n=Object.prototype,o=n.hasOwnProperty,i=n.toString,a=n.propertyIsEnumerable,c=Math.max;function l(e,t){var s=m(e)||function(e){return function(e){return function(e){return!!e&&"object"==typeof e}(e)&&g(e)}(e)&&o.call(e,"callee")&&(!a.call(e,"callee")||"[object Arguments]"==i.call(e))}(e)?function(e,t){for(var s=-1,r=Array(e);++s<e;)r[s]=t(s);return r}(e.length,String):[],r=s.length,n=!!r;for(var c in e)!t&&!o.call(e,c)||n&&("length"==c||d(c,r))||s.push(c);return s}function u(e,t,s,r){return void 0===e||y(e,n[s])&&!o.call(r,s)?t:e}function f(e,t,s){var r=e[t];o.call(e,t)&&y(r,s)&&(void 0!==s||t in e)||(e[t]=s)}function h(e){if(!b(e))return function(e){var t=[];if(null!=e)for(var s in Object(e))t.push(s);return t}(e);var t,s,r,i=(s=(t=e)&&t.constructor,r="function"==typeof s&&s.prototype||n,t===r),a=[];for(var c in e)("constructor"!=c||!i&&o.call(e,c))&&a.push(c);return a}function p(e,t){return t=c(void 0===t?e.length-1:t,0),function(){for(var s=arguments,n=-1,o=c(s.length-t,0),i=Array(o);++n<o;)i[n]=s[t+n];n=-1;for(var a=Array(t+1);++n<t;)a[n]=s[n];return a[t]=i,r(e,this,a)}}function d(e,t){return!!(t=null==t?9007199254740991:t)&&("number"==typeof e||s.test(e))&&e>-1&&e%1==0&&e<t}function y(e,t){return e===t||e!=e&&t!=t}var m=Array.isArray;function g(e){return null!=e&&function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}(e.length)&&!function(e){var t=b(e)?i.call(e):"";return"[object Function]"==t||"[object GeneratorFunction]"==t}(e)}function b(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}var S,k=(S=function(e,t,s,r){!function(e,t,s,r){s||(s={});for(var n=-1,o=t.length;++n<o;){var i=t[n],a=r?r(s[i],e[i],i,s,e):void 0;f(s,i,void 0===a?e[i]:a)}}(t,function(e){return g(e)?l(e,!0):h(e)}(t),e,r)},p((function(e,t){var s=-1,r=t.length,n=r>1?t[r-1]:void 0,o=r>2?t[2]:void 0;for(n=S.length>3&&"function"==typeof n?(r--,n):void 0,o&&function(e,t,s){if(!b(s))return!1;var r=typeof t;return!!("number"==r?g(s)&&d(t,s.length):"string"==r&&t in s)&&y(s[t],e)}(t[0],t[1],o)&&(n=r<3?void 0:n,r=1),e=Object(e);++s<r;){var i=t[s];i&&S(e,i,s,n)}return e}))),v=p((function(e){return e.push(void 0,u),r(k,void 0,e)}));e.exports=v},function(e,t){var s=Object.prototype,r=s.hasOwnProperty,n=s.toString,o=s.propertyIsEnumerable;e.exports=function(e){return function(e){return function(e){return!!e&&"object"==typeof e}(e)&&function(e){return null!=e&&function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}(e.length)&&!function(e){var t=function(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}(e)?n.call(e):"";return"[object Function]"==t||"[object GeneratorFunction]"==t}(e)}(e)}(e)&&r.call(e,"callee")&&(!o.call(e,"callee")||"[object Arguments]"==n.call(e))}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.genRedactedString=t.getStringValue=t.MAX_ARGUMENT_LENGTH=void 0;const r=s(40);t.MAX_ARGUMENT_LENGTH=200;function n(e){if(null!==e)switch(typeof e){case"boolean":case"number":return;case"object":if(Buffer.isBuffer(e))return e.toString("hex");if(Array.isArray(e))return e.join(",");try{return JSON.stringify(e)}catch(e){return}case"string":return e}}function o(e,t){const{length:s}=e;return s<=t?e:e.slice(0,t)+' ... <REDACTED full-length="'+s+'">'}t.getStringValue=n,t.genRedactedString=o,t.default=function(e){const t=(0,r.default)("ioredis:"+e);function s(...e){if(t.enabled){for(let t=1;t<e.length;t++){const s=n(e[t]);"string"==typeof s&&s.length>200&&(e[t]=o(s,200))}return t.apply(null,e)}}return Object.defineProperties(s,{namespace:{get:()=>t.namespace},enabled:{get:()=>t.enabled},destroy:{get:()=>t.destroy},log:{get:()=>t.log,set(e){t.log=e}}}),s}},function(e,t,s){"undefined"==typeof process||"renderer"===process.type||!0===process.browser||process.__nwjs?e.exports=s(41):e.exports=s(43)},function(e,t,s){t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const s="color: "+this.color;t.splice(1,0,s,"color: inherit");let r=0,n=0;t[0].replace(/%[a-zA-Z%]/g,e=>{"%%"!==e&&(r++,"%c"===e&&(n=r))}),t.splice(n,0,s)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){let e;try{e=t.storage.getItem("debug")}catch(e){}!e&&"undefined"!=typeof process&&"env"in process&&(e=process.env.DEBUG);return e},t.useColors=function(){if("undefined"!=typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let e;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&(e=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(e[1],10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage=function(){try{return localStorage}catch(e){}}(),t.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||(()=>{}),e.exports=s(21)(t);const{formatters:r}=e.exports;r.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}},function(e,t){var s=1e3,r=6e4,n=60*r,o=24*n;function i(e,t,s,r){var n=t>=1.5*s;return Math.round(e/s)+" "+r+(n?"s":"")}e.exports=function(e,t){t=t||{};var a=typeof e;if("string"===a&&e.length>0)return function(e){if((e=String(e)).length>100)return;var t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(!t)return;var i=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*i;case"weeks":case"week":case"w":return 6048e5*i;case"days":case"day":case"d":return i*o;case"hours":case"hour":case"hrs":case"hr":case"h":return i*n;case"minutes":case"minute":case"mins":case"min":case"m":return i*r;case"seconds":case"second":case"secs":case"sec":case"s":return i*s;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return i;default:return}}(e);if("number"===a&&isFinite(e))return t.long?function(e){var t=Math.abs(e);if(t>=o)return i(e,t,o,"day");if(t>=n)return i(e,t,n,"hour");if(t>=r)return i(e,t,r,"minute");if(t>=s)return i(e,t,s,"second");return e+" ms"}(e):function(e){var t=Math.abs(e);if(t>=o)return Math.round(e/o)+"d";if(t>=n)return Math.round(e/n)+"h";if(t>=r)return Math.round(e/r)+"m";if(t>=s)return Math.round(e/s)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},function(e,t,s){const r=s(44),n=s(7);t.init=function(e){e.inspectOpts={};const s=Object.keys(t.inspectOpts);for(let r=0;r<s.length;r++)e.inspectOpts[s[r]]=t.inspectOpts[s[r]]},t.log=function(...e){return process.stderr.write(n.formatWithOptions(t.inspectOpts,...e)+"\n")},t.formatArgs=function(s){const{namespace:r,useColors:n}=this;if(n){const t=this.color,n="[3"+(t<8?t:"8;5;"+t),o=`  ${n};1m${r} [0m`;s[0]=o+s[0].split("\n").join("\n"+o),s.push(n+"m+"+e.exports.humanize(this.diff)+"[0m")}else s[0]=function(){if(t.inspectOpts.hideDate)return"";return(new Date).toISOString()+" "}()+r+" "+s[0]},t.save=function(e){e?process.env.DEBUG=e:delete process.env.DEBUG},t.load=function(){return process.env.DEBUG},t.useColors=function(){return"colors"in t.inspectOpts?Boolean(t.inspectOpts.colors):r.isatty(process.stderr.fd)},t.destroy=n.deprecate(()=>{},"Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."),t.colors=[6,2,3,4,5,1];try{const e=s(45);e&&(e.stderr||e).level>=2&&(t.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch(e){}t.inspectOpts=Object.keys(process.env).filter(e=>/^debug_/i.test(e)).reduce((e,t)=>{const s=t.substring(6).toLowerCase().replace(/_([a-z])/g,(e,t)=>t.toUpperCase());let r=process.env[t];return r=!!/^(yes|on|true|enabled)$/i.test(r)||!/^(no|off|false|disabled)$/i.test(r)&&("null"===r?null:Number(r)),e[s]=r,e},{}),e.exports=s(21)(t);const{formatters:o}=e.exports;o.o=function(e){return this.inspectOpts.colors=this.useColors,n.inspect(e,this.inspectOpts).split("\n").map(e=>e.trim()).join(" ")},o.O=function(e){return this.inspectOpts.colors=this.useColors,n.inspect(e,this.inspectOpts)}},function(e,t){e.exports=require("tty")},function(e,t,s){"use strict";const r=s(17),n=s(46),o=process.env;let i;function a(e){return function(e){return 0!==e&&{level:e,hasBasic:!0,has256:e>=2,has16m:e>=3}}(function(e){if(!1===i)return 0;if(n("color=16m")||n("color=full")||n("color=truecolor"))return 3;if(n("color=256"))return 2;if(e&&!e.isTTY&&!0!==i)return 0;const t=i?1:0;if("win32"===process.platform){const e=r.release().split(".");return Number(process.versions.node.split(".")[0])>=8&&Number(e[0])>=10&&Number(e[2])>=10586?Number(e[2])>=14931?3:2:1}if("CI"in o)return["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI"].some(e=>e in o)||"codeship"===o.CI_NAME?1:t;if("TEAMCITY_VERSION"in o)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(o.TEAMCITY_VERSION)?1:0;if("truecolor"===o.COLORTERM)return 3;if("TERM_PROGRAM"in o){const e=parseInt((o.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(o.TERM_PROGRAM){case"iTerm.app":return e>=3?3:2;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(o.TERM)?2:/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(o.TERM)||"COLORTERM"in o?1:(o.TERM,t)}(e))}n("no-color")||n("no-colors")||n("color=false")?i=!1:(n("color")||n("colors")||n("color=true")||n("color=always"))&&(i=!0),"FORCE_COLOR"in o&&(i=0===o.FORCE_COLOR.length||0!==parseInt(o.FORCE_COLOR,10)),e.exports={supportsColor:a,stdout:a(process.stdout),stderr:a(process.stderr)}},function(e,t,s){"use strict";e.exports=(e,t)=>{t=t||process.argv;const s=e.startsWith("-")?"":1===e.length?"-":"--",r=t.indexOf(s+e),n=t.indexOf("--");return-1!==r&&(-1===n||r<n)}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r="-----BEGIN CERTIFICATE-----\nMIIDTzCCAjegAwIBAgIJAKSVpiDswLcwMA0GCSqGSIb3DQEBBQUAMD4xFjAUBgNV\nBAoMDUdhcmFudGlhIERhdGExJDAiBgNVBAMMG1NTTCBDZXJ0aWZpY2F0aW9uIEF1\ndGhvcml0eTAeFw0xMzEwMDExMjE0NTVaFw0yMzA5MjkxMjE0NTVaMD4xFjAUBgNV\nBAoMDUdhcmFudGlhIERhdGExJDAiBgNVBAMMG1NTTCBDZXJ0aWZpY2F0aW9uIEF1\ndGhvcml0eTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBALZqkh/DczWP\nJnxnHLQ7QL0T4B4CDKWBKCcisriGbA6ZePWVNo4hfKQC6JrzfR+081NeD6VcWUiz\nrmd+jtPhIY4c+WVQYm5PKaN6DT1imYdxQw7aqO5j2KUCEh/cznpLxeSHoTxlR34E\nQwF28Wl3eg2vc5ct8LjU3eozWVk3gb7alx9mSA2SgmuX5lEQawl++rSjsBStemY2\nBDwOpAMXIrdEyP/cVn8mkvi/BDs5M5G+09j0gfhyCzRWMQ7Hn71u1eolRxwVxgi3\nTMn+/vTaFSqxKjgck6zuAYjBRPaHe7qLxHNr1So/Mc9nPy+3wHebFwbIcnUojwbp\n4nctkWbjb2cCAwEAAaNQME4wHQYDVR0OBBYEFP1whtcrydmW3ZJeuSoKZIKjze3w\nMB8GA1UdIwQYMBaAFP1whtcrydmW3ZJeuSoKZIKjze3wMAwGA1UdEwQFMAMBAf8w\nDQYJKoZIhvcNAQEFBQADggEBAG2erXhwRAa7+ZOBs0B6X57Hwyd1R4kfmXcs0rta\nlbPpvgULSiB+TCbf3EbhJnHGyvdCY1tvlffLjdA7HJ0PCOn+YYLBA0pTU/dyvrN6\nSu8NuS5yubnt9mb13nDGYo1rnt0YRfxN+8DM3fXIVr038A30UlPX2Ou1ExFJT0MZ\nuFKY6ZvLdI6/1cbgmguMlAhM+DhKyV6Sr5699LM3zqeI816pZmlREETYkGr91q7k\nBpXJu/dtHaGxg1ZGu6w/PCsYGUcECWENYD4VQPd8N32JjOfu6vEgoEAwfPP+3oGp\nZ4m3ewACcWOAenqflb+cQYC4PsF7qbXDmRaWrbKntOlZ3n0=\n-----END CERTIFICATE-----\n-----BEGIN CERTIFICATE-----\nMIIGMTCCBBmgAwIBAgICEAAwDQYJKoZIhvcNAQELBQAwajELMAkGA1UEBhMCVVMx\nCzAJBgNVBAgMAkNBMQswCQYDVQQHDAJDQTESMBAGA1UECgwJUmVkaXNMYWJzMS0w\nKwYDVQQDDCRSZWRpc0xhYnMgUm9vdCBDZXJ0aWZpY2F0ZSBBdXRob3JpdHkwHhcN\nMTgwMjI1MTUzNzM3WhcNMjgwMjIzMTUzNzM3WjBfMQswCQYDVQQGEwJVUzELMAkG\nA1UECAwCQ0ExEjAQBgNVBAoMCVJlZGlzTGFiczEvMC0GA1UEAwwmUkNQIEludGVy\nbWVkaWF0ZSBDZXJ0aWZpY2F0ZSBBdXRob3JpdHkwggIiMA0GCSqGSIb3DQEBAQUA\nA4ICDwAwggIKAoICAQDf9dqbxc8Bq7Ctq9rWcxrGNKKHivqLAFpPq02yLPx6fsOv\nTq7GsDChAYBBc4v7Y2Ap9RD5Vs3dIhEANcnolf27QwrG9RMnnvzk8pCvp1o6zSU4\nVuOE1W66/O1/7e2rVxyrnTcP7UgK43zNIXu7+tiAqWsO92uSnuMoGPGpeaUm1jym\nhjWKtkAwDFSqvHY+XL5qDVBEjeUe+WHkYUg40cAXjusAqgm2hZt29c2wnVrxW25W\nP0meNlzHGFdA2AC5z54iRiqj57dTfBTkHoBczQxcyw6hhzxZQ4e5I5zOKjXXEhZN\nr0tA3YC14CTabKRus/JmZieyZzRgEy2oti64tmLYTqSlAD78pRL40VNoaSYetXLw\nhhNsXCHgWaY6d5bLOc/aIQMAV5oLvZQKvuXAF1IDmhPA+bZbpWipp0zagf1P1H3s\nUzsMdn2KM0ejzgotbtNlj5TcrVwpmvE3ktvUAuA+hi3FkVx1US+2Gsp5x4YOzJ7u\nP1WPk6ShF0JgnJH2ILdj6kttTWwFzH17keSFICWDfH/+kM+k7Y1v3EXMQXE7y0T9\nMjvJskz6d/nv+sQhY04xt64xFMGTnZjlJMzfQNi7zWFLTZnDD0lPowq7l3YiPoTT\nt5Xky83lu0KZsZBo0WlWaDG00gLVdtRgVbcuSWxpi5BdLb1kRab66JptWjxwXQID\nAQABo4HrMIHoMDoGA1UdHwQzMDEwL6AtoCuGKWh0dHBzOi8vcmwtY2Etc2VydmVy\nLnJlZGlzbGFicy5jb20vdjEvY3JsMEYGCCsGAQUFBwEBBDowODA2BggrBgEFBQcw\nAYYqaHR0cHM6Ly9ybC1jYS1zZXJ2ZXIucmVkaXNsYWJzLmNvbS92MS9vY3NwMB0G\nA1UdDgQWBBQHar5OKvQUpP2qWt6mckzToeCOHDAfBgNVHSMEGDAWgBQi42wH6hM4\nL2sujEvLM0/u8lRXTzASBgNVHRMBAf8ECDAGAQH/AgEAMA4GA1UdDwEB/wQEAwIB\nhjANBgkqhkiG9w0BAQsFAAOCAgEAirEn/iTsAKyhd+pu2W3Z5NjCko4NPU0EYUbr\nAP7+POK2rzjIrJO3nFYQ/LLuC7KCXG+2qwan2SAOGmqWst13Y+WHp44Kae0kaChW\nvcYLXXSoGQGC8QuFSNUdaeg3RbMDYFT04dOkqufeWVccoHVxyTSg9eD8LZuHn5jw\n7QDLiEECBmIJHk5Eeo2TAZrx4Yx6ufSUX5HeVjlAzqwtAqdt99uCJ/EL8bgpWbe+\nXoSpvUv0SEC1I1dCAhCKAvRlIOA6VBcmzg5Am12KzkqTul12/VEFIgzqu0Zy2Jbc\nAUPrYVu/+tOGXQaijy7YgwH8P8n3s7ZeUa1VABJHcxrxYduDDJBLZi+MjheUDaZ1\njQRHYevI2tlqeSBqdPKG4zBY5lS0GiAlmuze5oENt0P3XboHoZPHiqcK3VECgTVh\n/BkJcuudETSJcZDmQ8YfoKfBzRQNg2sv/hwvUv73Ss51Sco8GEt2lD8uEdib1Q6z\nzDT5lXJowSzOD5ZA9OGDjnSRL+2riNtKWKEqvtEG3VBJoBzu9GoxbAc7wIZLxmli\niF5a/Zf5X+UXD3s4TMmy6C4QZJpAA2egsSQCnraWO2ULhh7iXMysSkF/nzVfZn43\niqpaB8++9a37hWq14ZmOv0TJIDz//b2+KC4VFXWQ5W5QC6whsjT+OlG4p5ZYG0jo\n616pxqo=\n-----END CERTIFICATE-----\n-----BEGIN CERTIFICATE-----\nMIIFujCCA6KgAwIBAgIJAJ1aTT1lu2ScMA0GCSqGSIb3DQEBCwUAMGoxCzAJBgNV\nBAYTAlVTMQswCQYDVQQIDAJDQTELMAkGA1UEBwwCQ0ExEjAQBgNVBAoMCVJlZGlz\nTGFiczEtMCsGA1UEAwwkUmVkaXNMYWJzIFJvb3QgQ2VydGlmaWNhdGUgQXV0aG9y\naXR5MB4XDTE4MDIyNTE1MjA0MloXDTM4MDIyMDE1MjA0MlowajELMAkGA1UEBhMC\nVVMxCzAJBgNVBAgMAkNBMQswCQYDVQQHDAJDQTESMBAGA1UECgwJUmVkaXNMYWJz\nMS0wKwYDVQQDDCRSZWRpc0xhYnMgUm9vdCBDZXJ0aWZpY2F0ZSBBdXRob3JpdHkw\nggIiMA0GCSqGSIb3DQEBAQUAA4ICDwAwggIKAoICAQDLEjXy7YrbN5Waau5cd6g1\nG5C2tMmeTpZ0duFAPxNU4oE3RHS5gGiok346fUXuUxbZ6QkuzeN2/2Z+RmRcJhQY\nDm0ZgdG4x59An1TJfnzKKoWj8ISmoHS/TGNBdFzXV7FYNLBuqZouqePI6ReC6Qhl\npp45huV32Q3a6IDrrvx7Wo5ZczEQeFNbCeCOQYNDdTmCyEkHqc2AGo8eoIlSTutT\nULOC7R5gzJVTS0e1hesQ7jmqHjbO+VQS1NAL4/5K6cuTEqUl+XhVhPdLWBXJQ5ag\n54qhX4v+ojLzeU1R/Vc6NjMvVtptWY6JihpgplprN0Yh2556ewcXMeturcKgXfGJ\nxeYzsjzXerEjrVocX5V8BNrg64NlifzTMKNOOv4fVZszq1SIHR8F9ROrqiOdh8iC\nJpUbLpXH9hWCSEO6VRMB2xJoKu3cgl63kF30s77x7wLFMEHiwsQRKxooE1UhgS9K\n2sO4TlQ1eWUvFvHSTVDQDlGQ6zu4qjbOpb3Q8bQwoK+ai2alkXVR4Ltxe9QlgYK3\nStsnPhruzZGA0wbXdpw0bnM+YdlEm5ffSTpNIfgHeaa7Dtb801FtA71ZlH7A6TaI\nSIQuUST9EKmv7xrJyx0W1pGoPOLw5T029aTjnICSLdtV9bLwysrLhIYG5bnPq78B\ncS+jZHFGzD7PUVGQD01nOQIDAQABo2MwYTAdBgNVHQ4EFgQUIuNsB+oTOC9rLoxL\nyzNP7vJUV08wHwYDVR0jBBgwFoAUIuNsB+oTOC9rLoxLyzNP7vJUV08wDwYDVR0T\nAQH/BAUwAwEB/zAOBgNVHQ8BAf8EBAMCAYYwDQYJKoZIhvcNAQELBQADggIBAHfg\nz5pMNUAKdMzK1aS1EDdK9yKz4qicILz5czSLj1mC7HKDRy8cVADUxEICis++CsCu\nrYOvyCVergHQLREcxPq4rc5Nq1uj6J6649NEeh4WazOOjL4ZfQ1jVznMbGy+fJm3\n3Hoelv6jWRG9iqeJZja7/1s6YC6bWymI/OY1e4wUKeNHAo+Vger7MlHV+RuabaX+\nhSJ8bJAM59NCM7AgMTQpJCncrcdLeceYniGy5Q/qt2b5mJkQVkIdy4TPGGB+AXDJ\nD0q3I/JDRkDUFNFdeW0js7fHdsvCR7O3tJy5zIgEV/o/BCkmJVtuwPYOrw/yOlKj\nTY/U7ATAx9VFF6/vYEOMYSmrZlFX+98L6nJtwDqfLB5VTltqZ4H/KBxGE3IRSt9l\nFXy40U+LnXzhhW+7VBAvyYX8GEXhHkKU8Gqk1xitrqfBXY74xKgyUSTolFSfFVgj\nmcM/X4K45bka+qpkj7Kfv/8D4j6aZekwhN2ly6hhC1SmQ8qjMjpG/mrWOSSHZFmf\nybu9iD2AYHeIOkshIl6xYIa++Q/00/vs46IzAbQyriOi0XxlSMMVtPx0Q3isp+ji\nn8Mq9eOuxYOEQ4of8twUkUDd528iwGtEdwf0Q01UyT84S62N8AySl1ZBKXJz6W4F\nUhWfa/HQYOAPDdEjNgnVwLI23b8t0TozyCWw7q8h\n-----END CERTIFICATE-----\n\n-----BEGIN CERTIFICATE-----\nMIIEjzCCA3egAwIBAgIQe55B/ALCKJDZtdNT8kD6hTANBgkqhkiG9w0BAQsFADBM\nMSAwHgYDVQQLExdHbG9iYWxTaWduIFJvb3QgQ0EgLSBSMzETMBEGA1UEChMKR2xv\nYmFsU2lnbjETMBEGA1UEAxMKR2xvYmFsU2lnbjAeFw0yMjAxMjYxMjAwMDBaFw0y\nNTAxMjYwMDAwMDBaMFgxCzAJBgNVBAYTAkJFMRkwFwYDVQQKExBHbG9iYWxTaWdu\nIG52LXNhMS4wLAYDVQQDEyVHbG9iYWxTaWduIEF0bGFzIFIzIE9WIFRMUyBDQSAy\nMDIyIFEyMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAmGmg1LW9b7Lf\n8zDD83yBDTEkt+FOxKJZqF4veWc5KZsQj9HfnUS2e5nj/E+JImlGPsQuoiosLuXD\nBVBNAMcUFa11buFMGMeEMwiTmCXoXRrXQmH0qjpOfKgYc5gHG3BsRGaRrf7VR4eg\nofNMG9wUBw4/g/TT7+bQJdA4NfE7Y4d5gEryZiBGB/swaX6Jp/8MF4TgUmOWmalK\ndZCKyb4sPGQFRTtElk67F7vU+wdGcrcOx1tDcIB0ncjLPMnaFicagl+daWGsKqTh\ncounQb6QJtYHa91KvCfKWocMxQ7OIbB5UARLPmC4CJ1/f8YFm35ebfzAeULYdGXu\njE9CLor0OwIDAQABo4IBXzCCAVswDgYDVR0PAQH/BAQDAgGGMB0GA1UdJQQWMBQG\nCCsGAQUFBwMBBggrBgEFBQcDAjASBgNVHRMBAf8ECDAGAQH/AgEAMB0GA1UdDgQW\nBBSH5Zq7a7B/t95GfJWkDBpA8HHqdjAfBgNVHSMEGDAWgBSP8Et/qC5FJK5NUPpj\nmove4t0bvDB7BggrBgEFBQcBAQRvMG0wLgYIKwYBBQUHMAGGImh0dHA6Ly9vY3Nw\nMi5nbG9iYWxzaWduLmNvbS9yb290cjMwOwYIKwYBBQUHMAKGL2h0dHA6Ly9zZWN1\ncmUuZ2xvYmFsc2lnbi5jb20vY2FjZXJ0L3Jvb3QtcjMuY3J0MDYGA1UdHwQvMC0w\nK6ApoCeGJWh0dHA6Ly9jcmwuZ2xvYmFsc2lnbi5jb20vcm9vdC1yMy5jcmwwIQYD\nVR0gBBowGDAIBgZngQwBAgIwDAYKKwYBBAGgMgoBAjANBgkqhkiG9w0BAQsFAAOC\nAQEAKRic9/f+nmhQU/wz04APZLjgG5OgsuUOyUEZjKVhNGDwxGTvKhyXGGAMW2B/\n3bRi+aElpXwoxu3pL6fkElbX3B0BeS5LoDtxkyiVEBMZ8m+sXbocwlPyxrPbX6mY\n0rVIvnuUeBH8X0L5IwfpNVvKnBIilTbcebfHyXkPezGwz7E1yhUULjJFm2bt0SdX\ny+4X/WeiiYIv+fTVgZZgl+/2MKIsu/qdBJc3f3TvJ8nz+Eax1zgZmww+RSQWeOj3\n15Iw6Z5FX+NwzY/Ab+9PosR5UosSeq+9HhtaxZttXG1nVh+avYPGYddWmiMT90J5\nZgKnO/Fx2hBgTxhOTMYaD312kg==\n-----END CERTIFICATE-----\n\n-----BEGIN CERTIFICATE-----\nMIIDXzCCAkegAwIBAgILBAAAAAABIVhTCKIwDQYJKoZIhvcNAQELBQAwTDEgMB4G\nA1UECxMXR2xvYmFsU2lnbiBSb290IENBIC0gUjMxEzARBgNVBAoTCkdsb2JhbFNp\nZ24xEzARBgNVBAMTCkdsb2JhbFNpZ24wHhcNMDkwMzE4MTAwMDAwWhcNMjkwMzE4\nMTAwMDAwWjBMMSAwHgYDVQQLExdHbG9iYWxTaWduIFJvb3QgQ0EgLSBSMzETMBEG\nA1UEChMKR2xvYmFsU2lnbjETMBEGA1UEAxMKR2xvYmFsU2lnbjCCASIwDQYJKoZI\nhvcNAQEBBQADggEPADCCAQoCggEBAMwldpB5BngiFvXAg7aEyiie/QV2EcWtiHL8\nRgJDx7KKnQRfJMsuS+FggkbhUqsMgUdwbN1k0ev1LKMPgj0MK66X17YUhhB5uzsT\ngHeMCOFJ0mpiLx9e+pZo34knlTifBtc+ycsmWQ1z3rDI6SYOgxXG71uL0gRgykmm\nKPZpO/bLyCiR5Z2KYVc3rHQU3HTgOu5yLy6c+9C7v/U9AOEGM+iCK65TpjoWc4zd\nQQ4gOsC0p6Hpsk+QLjJg6VfLuQSSaGjlOCZgdbKfd/+RFO+uIEn8rUAVSNECMWEZ\nXriX7613t2Saer9fwRPvm2L7DWzgVGkWqQPabumDk3F2xmmFghcCAwEAAaNCMEAw\nDgYDVR0PAQH/BAQDAgEGMA8GA1UdEwEB/wQFMAMBAf8wHQYDVR0OBBYEFI/wS3+o\nLkUkrk1Q+mOai97i3Ru8MA0GCSqGSIb3DQEBCwUAA4IBAQBLQNvAUKr+yAzv95ZU\nRUm7lgAJQayzE4aGKAczymvmdLm6AC2upArT9fHxD4q/c2dKg8dEe3jgr25sbwMp\njjM5RcOO5LlXbKr8EpbsU8Yt5CRsuZRj+9xTaGdWPoO4zzUhw8lo/s7awlOqzJCK\n6fBdRoyV3XpYKBovHd7NADdBj+1EbddTKJd+82cEHhXXipa0095MJ6RMG3NzdvQX\nmcIfeg7jLQitChws/zyrVQ4PkX4268NXSb7hLi18YIvDQVETI53O9zJrlAGomecs\nMx86OyXShkDOOyyGeMlhLxS67ttVb9+E7gUJTb0o2HLO02JQZR7rkpeDMdmztcpH\nWD9f\n-----END CERTIFICATE-----",n={RedisCloudFixed:{ca:r},RedisCloudFlexible:{ca:r}};t.default=n},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(4);class n extends r.RedisError{constructor(e,t){super(e),this.lastNodeError=t,Error.captureStackTrace(this,this.constructor)}get name(){return this.constructor.name}}t.default=n,n.defaultMessage="Failed to refresh slots cache."},function(e,t){e.exports=require("stream")},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.executeWithAutoPipelining=t.getFirstValueInFlattenedArray=t.shouldUseAutoPipelining=t.notAllowedAutoPipelineCommands=t.kCallbacks=t.kExec=void 0;const r=s(9),n=s(8),o=s(3);function i(e,s){if(e._runningAutoPipelines.has(s))return;if(!e._autoPipelines.has(s))return;e._runningAutoPipelines.add(s);const r=e._autoPipelines.get(s);e._autoPipelines.delete(s);const n=r[t.kCallbacks];r[t.kCallbacks]=null,r.exec((function(t,r){if(e._runningAutoPipelines.delete(s),t)for(let e=0;e<n.length;e++)process.nextTick(n[e],t);else for(let e=0;e<n.length;e++)process.nextTick(n[e],...r[e]);e._autoPipelines.has(s)&&i(e,s)}))}function a(e){for(let t=0;t<e.length;t++){const s=e[t];if("string"==typeof s)return s;if(Array.isArray(s)||(0,r.isArguments)(s)){if(0===s.length)continue;return s[0]}const n=[s].flat();if(n.length>0)return n[0]}}t.kExec=Symbol("exec"),t.kCallbacks=Symbol("callbacks"),t.notAllowedAutoPipelineCommands=["auth","info","script","quit","cluster","pipeline","multi","subscribe","psubscribe","unsubscribe","unpsubscribe","select"],t.shouldUseAutoPipelining=function(e,s,r){return s&&e.options.enableAutoPipelining&&!e.isPipeline&&!t.notAllowedAutoPipelineCommands.includes(r)&&!e.options.autoPipeliningIgnoredCommands.includes(r)},t.getFirstValueInFlattenedArray=a,t.executeWithAutoPipelining=function e(s,c,l,u,f){if(s.isCluster&&!s.slots.length)return"wait"===s.status&&s.connect().catch(r.noop),(0,o.default)(new Promise((function(t,r){s.delayUntilReady(n=>{n?r(n):e(s,c,l,u,null).then(t,r)})})),f);const h=s.options.keyPrefix||"",p=s.isCluster?s.slots[n(`${h}${a(u)}`)].join(","):"main";if(!s._autoPipelines.has(p)){const e=s.pipeline();e[t.kExec]=!1,e[t.kCallbacks]=[],s._autoPipelines.set(p,e)}const d=s._autoPipelines.get(p);d[t.kExec]||(d[t.kExec]=!0,setImmediate(i,s,p));const y=new Promise((function(e,s){d[t.kCallbacks].push((function(t,r){t?s(t):e(r)})),"call"===c&&u.unshift(l),d[c](...u)}));return(0,o.default)(y,f)}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(18),n=s(1),o=s(3);t.default=class{constructor(e,t=null,s="",o=!1){this.lua=e,this.numberOfKeys=t,this.keyPrefix=s,this.readOnly=o,this.sha=(0,r.createHash)("sha1").update(e).digest("hex");const i=this.sha,a=new WeakSet;this.Command=class extends n.default{toWritable(t){const s=this.reject;return this.reject=e=>{-1!==e.message.indexOf("NOSCRIPT")&&a.delete(t),s.call(this,e)},a.has(t)?"eval"===this.name&&(this.name="evalsha",this.args[0]=i):(a.add(t),this.name="eval",this.args[0]=e),super.toWritable(t)}}}execute(e,t,s,r){"number"==typeof this.numberOfKeys&&t.unshift(this.numberOfKeys),this.keyPrefix&&(s.keyPrefix=this.keyPrefix),this.readOnly&&(s.readOnly=!0);const n=new this.Command("evalsha",[this.sha,...t],s);return n.promise=n.promise.catch(r=>{if(-1===r.message.indexOf("NOSCRIPT"))throw r;const n=new this.Command("evalsha",[this.sha,...t],s);return(e.isPipeline?e.redis:e).sendCommand(n)}),(0,o.default)(n.promise,r),e.sendCommand(n)}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_CLUSTER_OPTIONS=void 0;const r=s(53);t.DEFAULT_CLUSTER_OPTIONS={clusterRetryStrategy:e=>Math.min(100+2*e,2e3),enableOfflineQueue:!0,enableReadyCheck:!0,scaleReads:"master",maxRedirections:16,retryDelayOnMoved:0,retryDelayOnFailover:100,retryDelayOnClusterDown:100,retryDelayOnTryAgain:100,slotsRefreshTimeout:1e3,useSRVRecords:!1,resolveSrv:r.resolveSrv,dnsLookup:r.lookup,enableAutoPipelining:!1,autoPipeliningIgnoredCommands:[]}},function(e,t){e.exports=require("dns")},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(12),n=s(0),o=s(2),i=(0,n.Debug)("cluster:subscriber");t.default=class{constructor(e,t){this.connectionPool=e,this.emitter=t,this.started=!1,this.subscriber=null,this.onSubscriberEnd=()=>{this.started?(i("subscriber has disconnected, selecting a new one..."),this.selectSubscriber()):i("subscriber has disconnected, but ClusterSubscriber is not started, so not reconnecting.")},this.connectionPool.on("-node",(e,t)=>{this.started&&this.subscriber&&(0,r.getNodeKey)(this.subscriber.options)===t&&(i("subscriber has left, selecting a new one..."),this.selectSubscriber())}),this.connectionPool.on("+node",()=>{this.started&&!this.subscriber&&(i("a new node is discovered and there is no subscriber, selecting a new one..."),this.selectSubscriber())})}getInstance(){return this.subscriber}start(){this.started=!0,this.selectSubscriber(),i("started")}stop(){this.started=!1,this.subscriber&&(this.subscriber.disconnect(),this.subscriber=null),i("stopped")}selectSubscriber(){const e=this.lastActiveSubscriber;e&&(e.off("end",this.onSubscriberEnd),e.disconnect()),this.subscriber&&(this.subscriber.off("end",this.onSubscriberEnd),this.subscriber.disconnect());const t=(0,n.sample)(this.connectionPool.getNodes());if(!t)return i("selecting subscriber failed since there is no node discovered in the cluster yet"),void(this.subscriber=null);const{options:s}=t;i("selected a subscriber %s:%s",s.host,s.port),this.subscriber=new o.default({port:s.port,host:s.host,username:s.username,password:s.password,enableReadyCheck:!0,connectionName:(0,r.getConnectionName)("subscriber",s.connectionName),lazyConnect:!0,tls:s.tls,retryStrategy:null}),this.subscriber.on("error",n.noop),this.subscriber.once("end",this.onSubscriberEnd);const a={subscribe:[],psubscribe:[],ssubscribe:[]};if(e){const t=e.condition||e.prevCondition;t&&t.subscriber&&(a.subscribe=t.subscriber.channels("subscribe"),a.psubscribe=t.subscriber.channels("psubscribe"),a.ssubscribe=t.subscriber.channels("ssubscribe"))}if(a.subscribe.length||a.psubscribe.length||a.ssubscribe.length){let e=0;for(const t of["subscribe","psubscribe","ssubscribe"]){const s=a[t];s.length&&(e+=1,i("%s %d channels",t,s.length),this.subscriber[t](s).then(()=>{--e||(this.lastActiveSubscriber=this.subscriber)}).catch(()=>{i("failed to %s %d channels",t,s.length)}))}}else this.lastActiveSubscriber=this.subscriber;for(const e of["message","messageBuffer","smessage","smessageBuffer"])this.subscriber.on(e,(t,s)=>{this.emitter.emit(e,t,s)});for(const e of["pmessage","pmessageBuffer"])this.subscriber.on(e,(t,s,r)=>{this.emitter.emit(e,t,s,r)})}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(6),n=s(0),o=s(12),i=s(2),a=(0,n.Debug)("cluster:connectionPool");class c extends r.EventEmitter{constructor(e){super(),this.redisOptions=e,this.nodes={all:{},master:{},slave:{}},this.specifiedOptions={}}getNodes(e="all"){const t=this.nodes[e];return Object.keys(t).map(e=>t[e])}getInstanceByKey(e){return this.nodes.all[e]}getSampleInstance(e){const t=Object.keys(this.nodes[e]),s=(0,n.sample)(t);return this.nodes[e][s]}findOrCreate(e,t=!1){const s=(0,o.getNodeKey)(e);let r;return t=Boolean(t),this.specifiedOptions[s]?Object.assign(e,this.specifiedOptions[s]):this.specifiedOptions[s]=e,this.nodes.all[s]?(r=this.nodes.all[s],r.options.readOnly!==t&&(r.options.readOnly=t,a("Change role of %s to %s",s,t?"slave":"master"),r[t?"readonly":"readwrite"]().catch(n.noop),t?(delete this.nodes.master[s],this.nodes.slave[s]=r):(delete this.nodes.slave[s],this.nodes.master[s]=r))):(a("Connecting to %s as %s",s,t?"slave":"master"),r=new i.default((0,n.defaults)({retryStrategy:null,enableOfflineQueue:!0,readOnly:t},e,this.redisOptions,{lazyConnect:!0})),this.nodes.all[s]=r,this.nodes[t?"slave":"master"][s]=r,r.once("end",()=>{this.removeNode(s),this.emit("-node",r,s),Object.keys(this.nodes.all).length||this.emit("drain")}),this.emit("+node",r,s),r.on("error",(function(e){this.emit("nodeError",e,s)}))),r}reset(e){a("Reset with %O",e);const t={};e.forEach(e=>{const s=(0,o.getNodeKey)(e);e.readOnly&&t[s]||(t[s]=e)}),Object.keys(this.nodes.all).forEach(e=>{t[e]||(a("Disconnect %s because the node does not hold any slot",e),this.nodes.all[e].disconnect(),this.removeNode(e))}),Object.keys(t).forEach(e=>{const s=t[e];this.findOrCreate(s,s.readOnly)})}removeNode(e){const{nodes:t}=this;t.all[e]&&(a("Remove %s from the pool",e),delete t.all[e]),delete t.master[e],delete t.slave[e]}}t.default=c},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(0),n=s(14),o=(0,r.Debug)("delayqueue");t.default=class{constructor(){this.queues={},this.timeouts={}}push(e,t,s){const r=s.callback||process.nextTick;this.queues[e]||(this.queues[e]=new n);this.queues[e].push(t),this.timeouts[e]||(this.timeouts[e]=setTimeout(()=>{r(()=>{this.timeouts[e]=null,this.execute(e)})},s.timeout))}execute(e){const t=this.queues[e];if(!t)return;const{length:s}=t;if(s)for(o("send %d commands in %s queue",s,e),this.queues[e]=null;t.length>0;)t.shift()()}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SentinelConnector=t.StandaloneConnector=void 0;const r=s(58);t.StandaloneConnector=r.default;const n=s(16);t.SentinelConnector=n.default},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(13),n=s(25),o=s(0),i=s(15);class a extends i.default{constructor(e){super(e.disconnectTimeout),this.options=e}connect(e){const{options:t}=this;let s;return this.connecting=!0,"path"in t&&t.path?s={path:t.path}:(s={},"port"in t&&null!=t.port&&(s.port=t.port),"host"in t&&null!=t.host&&(s.host=t.host),"family"in t&&null!=t.family&&(s.family=t.family)),t.tls&&Object.assign(s,t.tls),new Promise((e,i)=>{process.nextTick(()=>{if(this.connecting){try{t.tls?this.stream=(0,n.connect)(s):this.stream=(0,r.createConnection)(s)}catch(e){return void i(e)}this.stream.once("error",e=>{this.firstError=e}),e(this.stream)}else i(new Error(o.CONNECTION_CLOSED_ERROR_MSG))})})}}t.default=a},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(e){this.cursor=0,this.sentinels=e.slice(0)}next(){const e=this.cursor>=this.sentinels.length;return{done:e,value:e?void 0:this.sentinels[this.cursor++]}}reset(e){e&&this.sentinels.length>1&&1!==this.cursor&&this.sentinels.unshift(...this.sentinels.splice(this.cursor-1)),this.cursor=0}add(e){for(let r=0;r<this.sentinels.length;r++)if(t=e,s=this.sentinels[r],(t.host||"127.0.0.1")===(s.host||"127.0.0.1")&&(t.port||26379)===(s.port||26379))return!1;var t,s;return this.sentinels.push(e),!0}toString(){return`${JSON.stringify(this.sentinels)} @${this.cursor}`}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FailoverDetector=void 0;const r=(0,s(0).Debug)("FailoverDetector");t.FailoverDetector=class{constructor(e,t){this.isDisconnected=!1,this.connector=e,this.sentinels=t}cleanup(){this.isDisconnected=!0;for(const e of this.sentinels)e.client.disconnect()}async subscribe(){r("Starting FailoverDetector");const e=[];for(const t of this.sentinels){const s=t.client.subscribe("+switch-master").catch(e=>{r("Failed to subscribe to failover messages on sentinel %s:%s (%s)",t.address.host||"127.0.0.1",t.address.port||26739,e.message)});e.push(s),t.client.on("message",e=>{this.isDisconnected||"+switch-master"!==e||this.disconnect()})}await Promise.all(e)}disconnect(){this.isDisconnected=!0,r("Failover detected, disconnecting"),this.connector.disconnect()}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.readyHandler=t.errorHandler=t.closeHandler=t.connectHandler=void 0;const r=s(4),n=s(1),o=s(62),i=s(0),a=s(64),c=(0,i.Debug)("connection");function l(e){const t=new r.AbortError("Command aborted due to connection close");return t.command={name:e.name,args:e.args},t}t.connectHandler=function(e){return function(){e.setStatus("connect"),e.resetCommandQueue();let s=!1;const{connectionEpoch:r}=e;e.condition.auth&&e.auth(e.condition.auth,(function(t){r===e.connectionEpoch&&t&&(-1!==t.message.indexOf("no password is set")?console.warn("[WARN] Redis server does not require a password, but a password was supplied."):-1!==t.message.indexOf("without any password configured for the default user")?console.warn("[WARN] This Redis server's `default` user does not require a password, but a password was supplied"):-1!==t.message.indexOf("wrong number of arguments for 'auth' command")?console.warn("[ERROR] The server returned \"wrong number of arguments for 'auth' command\". You are probably passing both username and password to Redis version 5 or below. You should only pass the 'password' option for Redis version 5 and under."):(s=!0,e.recoverFromFatalError(t,t)))})),e.condition.select&&e.select(e.condition.select).catch(t=>{e.silentEmit("error",t)}),e.options.enableReadyCheck||t.readyHandler(e)(),new a.default(e,{stringNumbers:e.options.stringNumbers}),e.options.enableReadyCheck&&e._readyCheck((function(n,o){r===e.connectionEpoch&&(n?s||e.recoverFromFatalError(new Error("Ready check failed: "+n.message),n):e.connector.check(o)?t.readyHandler(e)():e.disconnect(!0))}))}},t.closeHandler=function(e){return function(){const s=e.status;if(e.setStatus("close"),e.commandQueue.length&&function(e){var t;let s=0;for(let r=0;r<e.length;){const n=null===(t=e.peekAt(r))||void 0===t?void 0:t.command,o=n.pipelineIndex;void 0!==o&&0!==o||(s=0),void 0===o||o===s++?r++:(e.remove(r,1),n.reject(l(n)))}}(e.commandQueue),e.offlineQueue.length&&function(e){var t;for(let s=0;s<e.length;){const r=null===(t=e.peekAt(s))||void 0===t?void 0:t.command;if("multi"===r.name)break;if("exec"===r.name){e.remove(s,1),r.reject(l(r));break}r.inTransaction?(e.remove(s,1),r.reject(l(r))):s++}}(e.offlineQueue),"ready"===s&&(e.prevCondition||(e.prevCondition=e.condition),e.commandQueue.length&&(e.prevCommandQueue=e.commandQueue)),e.manuallyClosing)return e.manuallyClosing=!1,c("skip reconnecting since the connection is manually closed."),t();if("function"!=typeof e.options.retryStrategy)return c("skip reconnecting because `retryStrategy` is not a function"),t();const r=e.options.retryStrategy(++e.retryAttempts);if("number"!=typeof r)return c("skip reconnecting because `retryStrategy` doesn't return a number"),t();c("reconnect in %sms",r),e.setStatus("reconnecting",r),e.reconnectTimeout=setTimeout((function(){e.reconnectTimeout=null,e.connect().catch(i.noop)}),r);const{maxRetriesPerRequest:n}=e.options;if("number"==typeof n)if(n<0)c("maxRetriesPerRequest is negative, ignoring...");else{0===e.retryAttempts%(n+1)&&(c("reach maxRetriesPerRequest limitation, flushing command queue..."),e.flushQueue(new o.MaxRetriesPerRequestError(n)))}};function t(){e.setStatus("end"),e.flushQueue(new Error(i.CONNECTION_CLOSED_ERROR_MSG))}},t.errorHandler=function(e){return function(t){c("error: %s",t),e.silentEmit("error",t)}},t.readyHandler=function(e){return function(){if(e.setStatus("ready"),e.retryAttempts=0,e.options.monitor){e.call("monitor").then(()=>e.setStatus("monitoring"),t=>e.emit("error",t));const{sendCommand:t}=e;return e.sendCommand=function(s){return n.default.checkFlag("VALID_IN_MONITOR_MODE",s.name)?t.call(e,s):(s.reject(new Error("Connection is in monitoring mode, can't process commands.")),s.promise)},void e.once("close",(function(){delete e.sendCommand}))}const t=e.prevCondition?e.prevCondition.select:e.condition.select;if(e.options.connectionName&&(c("set the connection name [%s]",e.options.connectionName),e.client("setname",e.options.connectionName).catch(i.noop)),e.options.readOnly&&(c("set the connection to readonly mode"),e.readonly().catch(i.noop)),e.prevCondition){const s=e.prevCondition;if(e.prevCondition=null,s.subscriber&&e.options.autoResubscribe){e.condition.select!==t&&(c("connect to db [%d]",t),e.select(t));const r=s.subscriber.channels("subscribe");r.length&&(c("subscribe %d channels",r.length),e.subscribe(r));const n=s.subscriber.channels("psubscribe");n.length&&(c("psubscribe %d channels",n.length),e.psubscribe(n));const o=s.subscriber.channels("ssubscribe");o.length&&(c("ssubscribe %d channels",o.length),e.ssubscribe(o))}}if(e.prevCommandQueue)if(e.options.autoResendUnfulfilledCommands)for(c("resend %d unfulfilled commands",e.prevCommandQueue.length);e.prevCommandQueue.length>0;){const t=e.prevCommandQueue.shift();t.select!==e.condition.select&&"select"!==t.command.name&&e.select(t.select),e.sendCommand(t.command,t.stream)}else e.prevCommandQueue=null;if(e.offlineQueue.length){c("send %d commands in offline queue",e.offlineQueue.length);const t=e.offlineQueue;for(e.resetOfflineQueue();t.length>0;){const s=t.shift();s.select!==e.condition.select&&"select"!==s.command.name&&e.select(s.select),e.sendCommand(s.command,s.stream)}}e.condition.select!==t&&(c("connect to db [%d]",t),e.select(t))}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MaxRetriesPerRequestError=void 0;const r=s(63);t.MaxRetriesPerRequestError=r.default},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(4);class n extends r.AbortError{constructor(e){super(`Reached the max retries per request limit (which is ${e}). Refer to "maxRetriesPerRequest" option for details.`),Error.captureStackTrace(this,this.constructor)}get name(){return this.constructor.name}}t.default=n},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(1),n=s(0),o=s(65),i=s(69),a=(0,n.Debug)("dataHandler");t.default=class{constructor(e,t){this.redis=e;const s=new o({stringNumbers:t.stringNumbers,returnBuffers:!0,returnError:e=>{this.returnError(e)},returnFatalError:e=>{this.returnFatalError(e)},returnReply:e=>{this.returnReply(e)}});e.stream.on("data",e=>{s.execute(e)})}returnFatalError(e){e.message+=". Please report this.",this.redis.recoverFromFatalError(e,e,{offlineQueue:!1})}returnError(e){const t=this.shiftCommand(e);t&&(e.command={name:t.command.name,args:t.command.args},this.redis.handleReconnection(e,t))}returnReply(e){if(this.handleMonitorReply(e))return;if(this.handleSubscriberReply(e))return;const t=this.shiftCommand(e);t&&(r.default.checkFlag("ENTER_SUBSCRIBER_MODE",t.command.name)?(this.redis.condition.subscriber=new i.default,this.redis.condition.subscriber.add(t.command.name,e[1].toString()),l(t.command,e[2])||this.redis.commandQueue.unshift(t)):r.default.checkFlag("EXIT_SUBSCRIBER_MODE",t.command.name)?u(t.command,e[2])||this.redis.commandQueue.unshift(t):t.command.resolve(e))}handleSubscriberReply(e){if(!this.redis.condition.subscriber)return!1;const t=Array.isArray(e)?e[0].toString():null;switch(a('receive reply "%s" in subscriber mode',t),t){case"message":this.redis.listeners("message").length>0&&this.redis.emit("message",e[1].toString(),e[2]?e[2].toString():""),this.redis.emit("messageBuffer",e[1],e[2]);break;case"pmessage":{const t=e[1].toString();this.redis.listeners("pmessage").length>0&&this.redis.emit("pmessage",t,e[2].toString(),e[3].toString()),this.redis.emit("pmessageBuffer",t,e[2],e[3]);break}case"smessage":this.redis.listeners("smessage").length>0&&this.redis.emit("smessage",e[1].toString(),e[2]?e[2].toString():""),this.redis.emit("smessageBuffer",e[1],e[2]);break;case"ssubscribe":case"subscribe":case"psubscribe":{const s=e[1].toString();this.redis.condition.subscriber.add(t,s);const r=this.shiftCommand(e);if(!r)return;l(r.command,e[2])||this.redis.commandQueue.unshift(r);break}case"sunsubscribe":case"unsubscribe":case"punsubscribe":{const s=e[1]?e[1].toString():null;s&&this.redis.condition.subscriber.del(t,s);const r=e[2];0===Number(r)&&(this.redis.condition.subscriber=!1);const n=this.shiftCommand(e);if(!n)return;u(n.command,r)||this.redis.commandQueue.unshift(n);break}default:{const t=this.shiftCommand(e);if(!t)return;t.command.resolve(e)}}return!0}handleMonitorReply(e){if("monitoring"!==this.redis.status)return!1;const t=e.toString();if("OK"===t)return!1;const s=t.indexOf(" "),r=t.slice(0,s),n=t.indexOf('"'),o=t.slice(n+1,-1).split('" "').map(e=>e.replace(/\\"/g,'"')),i=t.slice(s+2,n-2).split(" ");return this.redis.emit("monitor",r,o,i[1],i[0]),!0}shiftCommand(e){const t=this.redis.commandQueue.shift();if(!t){const t=new Error("Command queue state error. If you can reproduce this, please report it."+(e instanceof Error?" Last error: "+e.message:" Last reply: "+e.toString()));return this.redis.emit("error",t),null}return t}};const c=new WeakMap;function l(e,t){let s=c.has(e)?c.get(e):e.args.length;return s-=1,s<=0?(e.resolve(t),c.delete(e),!0):(c.set(e,s),!1)}function u(e,t){let s=c.has(e)?c.get(e):e.args.length;return 0===s?0===Number(t)&&(c.delete(e),e.resolve(t),!0):(s-=1,s<=0?(e.resolve(t),!0):(c.set(e,s),!1))}},function(e,t,s){"use strict";e.exports=s(66)},function(e,t,s){"use strict";const r=s(67).Buffer,n=new(0,s(68).StringDecoder),o=s(4),i=o.ReplyError,a=o.ParserError;var c=r.allocUnsafe(32768),l=0,u=null,f=0,h=0;function p(e){const t=e.offset,s=e.buffer,r=s.length-1;for(var n=t;n<r;)if(13===s[n++])return e.offset=n+1,!0===e.optionReturnBuffers?e.buffer.slice(t,n-1):e.buffer.toString("utf8",t,n-1)}function d(e){const t=e.buffer.length-1;for(var s=e.offset,r=0;s<t;){const t=e.buffer[s++];if(13===t)return e.offset=s+1,r;r=10*r+(t-48)}}function y(e,t,s){e.arrayCache.push(t),e.arrayPos.push(s)}function m(e){const t=e.arrayCache.pop();var s=e.arrayPos.pop();if(e.arrayCache.length){const r=m(e);if(void 0===r)return void y(e,t,s);t[s++]=r}return g(e,t,s)}function g(e,t,s){const r=e.buffer.length;for(;s<t.length;){const n=e.offset;if(e.offset>=r)return void y(e,t,s);const o=b(e,e.buffer[e.offset++]);if(void 0===o)return e.arrayCache.length||e.bufferCache.length||(e.offset=n),void y(e,t,s);t[s]=o,s++}return t}function b(e,t){switch(t){case 36:return function(e){const t=d(e);if(void 0===t)return;if(t<0)return null;const s=e.offset+t;if(s+2>e.buffer.length)return e.bigStrSize=s+2,e.totalChunkSize=e.buffer.length,void e.bufferCache.push(e.buffer);const r=e.offset;return e.offset=s+2,!0===e.optionReturnBuffers?e.buffer.slice(r,s):e.buffer.toString("utf8",r,s)}(e);case 43:return p(e);case 42:return function(e){const t=d(e);if(void 0===t)return;return t<0?null:g(e,new Array(t),0)}(e);case 58:return function(e){return!0===e.optionStringNumbers?function(e){const t=e.buffer.length-1;var s=e.offset,r=0,n="";for(45===e.buffer[s]&&(n+="-",s++);s<t;){var o=e.buffer[s++];if(13===o)return e.offset=s+1,0!==r&&(n+=r),n;r>429496728?(n+=10*r+(o-48),r=0):48===o&&0===r?n+=0:r=10*r+(o-48)}}(e):function(e){const t=e.buffer.length-1;var s=e.offset,r=0,n=1;for(45===e.buffer[s]&&(n=-1,s++);s<t;){const t=e.buffer[s++];if(13===t)return e.offset=s+1,n*r;r=10*r+(t-48)}}(e)}(e);case 45:return function(e){var t=p(e);if(void 0!==t)return!0===e.optionReturnBuffers&&(t=t.toString()),new i(t)}(e);default:return function(e,t){const s=new a("Protocol error, got "+JSON.stringify(String.fromCharCode(t))+" as reply type byte",JSON.stringify(e.buffer),e.offset);e.buffer=null,e.returnFatalError(s)}(e,t)}}function S(){if(c.length>51200)if(1===f||h>2*f){const e=Math.floor(c.length/10),t=e<l?l:e;l=0,c=c.slice(t,c.length)}else h++,f--;else clearInterval(u),f=0,h=0,u=null}function k(e){const t=e.bufferCache,s=e.offset,n=e.bigStrSize-s-2;var o=t.length,i=e.bigStrSize-e.totalChunkSize;if(e.offset=i,i<=2){if(2===o)return t[0].slice(s,t[0].length+i-2);o--,i=t[t.length-2].length+i}!function(e){if(c.length<e+l){const t=e>78643200?2:3;l>116391936&&(l=52428800),c=r.allocUnsafe(e*t+l),l=0,f++,null===u&&(u=setInterval(S,50))}}(n);const a=l;t[0].copy(c,a,s,t[0].length),l+=t[0].length-s;for(var h=1;h<o-1;h++)t[h].copy(c,l),l+=t[h].length;return t[h].copy(c,l,0,i-2),l+=i-2,c.slice(a,l)}e.exports=class{constructor(e){if(!e)throw new TypeError("Options are mandatory.");if("function"!=typeof e.returnError||"function"!=typeof e.returnReply)throw new TypeError("The returnReply and returnError options have to be functions.");this.setReturnBuffers(!!e.returnBuffers),this.setStringNumbers(!!e.stringNumbers),this.returnError=e.returnError,this.returnFatalError=e.returnFatalError||e.returnError,this.returnReply=e.returnReply,this.reset()}reset(){this.offset=0,this.buffer=null,this.bigStrSize=0,this.totalChunkSize=0,this.bufferCache=[],this.arrayCache=[],this.arrayPos=[]}setReturnBuffers(e){if("boolean"!=typeof e)throw new TypeError("The returnBuffers argument has to be a boolean");this.optionReturnBuffers=e}setStringNumbers(e){if("boolean"!=typeof e)throw new TypeError("The stringNumbers argument has to be a boolean");this.optionStringNumbers=e}execute(e){if(null===this.buffer)this.buffer=e,this.offset=0;else if(0===this.bigStrSize){const t=this.buffer.length,s=t-this.offset,n=r.allocUnsafe(s+e.length);if(this.buffer.copy(n,0,this.offset,t),e.copy(n,s,0,e.length),this.buffer=n,this.offset=0,this.arrayCache.length){const e=m(this);if(void 0===e)return;this.returnReply(e)}}else{if(!(this.totalChunkSize+e.length>=this.bigStrSize))return this.bufferCache.push(e),void(this.totalChunkSize+=e.length);this.bufferCache.push(e);var t=this.optionReturnBuffers?k(this):function(e){const t=e.bufferCache,s=e.offset;var r=t.length,o=e.bigStrSize-e.totalChunkSize;if(e.offset=o,o<=2){if(2===r)return t[0].toString("utf8",s,t[0].length+o-2);r--,o=t[t.length-2].length+o}for(var i=n.write(t[0].slice(s)),a=1;a<r-1;a++)i+=n.write(t[a]);return i+=n.end(t[a].slice(0,o-2))}(this);if(this.bigStrSize=0,this.bufferCache=[],this.buffer=e,this.arrayCache.length&&(this.arrayCache[0][this.arrayPos[0]++]=t,void 0===(t=m(this))))return;this.returnReply(t)}for(;this.offset<this.buffer.length;){const e=this.offset,t=this.buffer[this.offset++],s=b(this,t);if(void 0===s)return void(this.arrayCache.length||this.bufferCache.length||(this.offset=e));45===t?this.returnError(s):this.returnReply(s)}this.buffer=null}}},function(e,t){e.exports=require("buffer")},function(e,t){e.exports=require("string_decoder")},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function r(e){return"unsubscribe"===e?"subscribe":"punsubscribe"===e?"psubscribe":"sunsubscribe"===e?"ssubscribe":e}t.default=class{constructor(){this.set={subscribe:{},psubscribe:{},ssubscribe:{}}}add(e,t){this.set[r(e)][t]=!0}del(e,t){delete this.set[r(e)][t]}channels(e){return Object.keys(this.set[r(e)])}isEmpty(){return 0===this.channels("subscribe").length&&0===this.channels("psubscribe").length&&0===this.channels("ssubscribe").length}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_REDIS_OPTIONS=void 0,t.DEFAULT_REDIS_OPTIONS={port:6379,host:"localhost",family:4,connectTimeout:1e4,disconnectTimeout:2e3,retryStrategy:function(e){return Math.min(50*e,2e3)},keepAlive:0,noDelay:!0,connectionName:null,sentinels:null,name:null,role:"master",sentinelRetryStrategy:function(e){return Math.min(10*e,1e3)},sentinelReconnectStrategy:function(){return 6e4},natMap:null,enableTLSForSentinelMode:!1,updateSentinels:!0,failoverDetector:!1,username:null,password:null,db:0,enableOfflineQueue:!0,enableReadyCheck:!0,autoResubscribe:!0,autoResendUnfulfilledCommands:!0,lazyConnect:!1,keyPrefix:"",reconnectOnError:null,readOnly:!1,stringNumbers:!1,maxRetriesPerRequest:20,maxLoadingRetryTime:1e4,enableAutoPipelining:!1,autoPipeliningIgnoredCommands:[],sentinelMaxConnections:10}},function(e,t,s){"use strict";e.exports={"Access-Control-Allow-Origin":"*","Access-Control-Allow-Headers":"content-type","Access-Control-Allow-Methods":"POST, GET, PUT, DELETE, OPTIONS"}},,,,,,function(e,t,s){"use strict";function r(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,r)}return s}function n(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var r=s.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const o=s(26),i=s(71);t.handler=async(e,t)=>{if("OPTIONS"==e.httpMethod)return{statusCode:200,headers:i,body:"OK"};try{const t=e.path.split("/").reverse()[0];o.on("connect",(function(){console.log("You are now connected")}));const s=JSON.parse(e.body);return await o.set("designer_"+t,JSON.stringify(function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?r(Object(s),!0).forEach((function(t){n(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):r(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}({id:t},s))),{statusCode:200,headers:i,body:"OK"}}catch(e){return console.log(e),{statusCode:400,headers:i,body:JSON.stringify(e)}}}}]));